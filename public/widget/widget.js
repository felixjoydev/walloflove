var ye=k=>{throw TypeError(k)};var Ft=(k,M,C)=>M.has(k)||ye("Cannot "+C);var n=(k,M,C)=>(Ft(k,M,"read from private field"),C?C.call(k):M.get(k)),h=(k,M,C)=>M.has(k)?ye("Cannot add the same private member more than once"):M instanceof WeakSet?M.add(k):M.set(k,C),d=(k,M,C,Y)=>(Ft(k,M,"write to private field"),Y?Y.call(k,C):M.set(k,C),C),f=(k,M,C)=>(Ft(k,M,"access private method"),C);(function(){"use strict";var _t,Q,v,R,tt,z,$,B,at,dt,ut,w,lt,p,ke,we,Ee,Ce,Le,wt,Me,_e,Se,Ae,Ne,Yt,b,ht,D,A,T,et,bt,ft,nt,st,it,ct,_,ze,mt,gt,K,Vt,Et,zt;let k="";function M(e){k=e.replace(/\/$/,"")}const C=new Map,Y=new Map;function Xt(e){const t=`/api/v1/guestbooks/${e}/entries`;for(const s of Array.from(C.keys()))s.startsWith(t)&&C.delete(s);for(const s of Array.from(Y.keys()))s.startsWith(t)&&Y.delete(s)}async function Ct(e,t){const s=`${k}${e}`,i={"Content-Type":"application/json"};if(t?.useEtag){const r=C.get(e);r&&(i["If-None-Match"]=r)}try{const r=await fetch(s,{...t,headers:{...i,...t?.headers}});if(r.status===304)return Y.has(e)?{ok:!0,data:Y.get(e)}:{ok:!0,data:null};if(!r.ok)return{ok:!1,error:await r.json().catch(()=>({error:r.statusText}))};if(t?.useEtag){const a=r.headers.get("ETag");a&&C.set(e,a)}const o=await r.json();return t?.useEtag&&Y.set(e,o),{ok:!0,data:o}}catch{return{ok:!1,error:{error:"Network error"}}}}function $e(e){return Ct(`/api/v1/guestbooks/${e}`)}function Lt(e,t){const s=t?`?cursor=${encodeURIComponent(t)}`:"";return Ct(`/api/v1/guestbooks/${e}/entries${s}`,{useEtag:!t})}function Te(e,t){return Ct(`/api/v1/guestbooks/${e}/entries`,{method:"POST",body:JSON.stringify(t)}).then(s=>(s.ok&&Xt(e),s))}function Pe(e,t,s){return Ct(`/api/v1/guestbooks/${e}/entries/${t}`,{method:"DELETE",body:JSON.stringify({deletion_token:s})}).then(i=>(i.ok&&Xt(e),i))}const{PI:Ie}=Math,pt=Ie+1e-4,Jt=.5,Zt=[1,1];function Qt(e,t,s,i=r=>r){return e*i(.5-t*(.5-s))}const{min:$t}=Math;function te(e,t,s){let i=$t(1,t/s);return $t(1,e+($t(1,1-i)-e)*(i*.275))}function Re(e){return[-e[0],-e[1]]}function q(e,t){return[e[0]+t[0],e[1]+t[1]]}function ee(e,t,s){return e[0]=t[0]+s[0],e[1]=t[1]+s[1],e}function V(e,t){return[e[0]-t[0],e[1]-t[1]]}function Tt(e,t,s){return e[0]=t[0]-s[0],e[1]=t[1]-s[1],e}function X(e,t){return[e[0]*t,e[1]*t]}function Pt(e,t,s){return e[0]=t[0]*s,e[1]=t[1]*s,e}function De(e,t){return[e[0]/t,e[1]/t]}function ne(e){return[e[1],-e[0]]}function It(e,t){let s=t[0];return e[0]=t[1],e[1]=-s,e}function se(e,t){return e[0]*t[0]+e[1]*t[1]}function Oe(e,t){return e[0]===t[0]&&e[1]===t[1]}function He(e){return Math.hypot(e[0],e[1])}function ie(e,t){let s=e[0]-t[0],i=e[1]-t[1];return s*s+i*i}function oe(e){return De(e,He(e))}function je(e,t){return Math.hypot(e[1]-t[1],e[0]-t[0])}function Rt(e,t,s){let i=Math.sin(s),r=Math.cos(s),o=e[0]-t[0],a=e[1]-t[1],l=o*r-a*i,c=o*i+a*r;return[l+t[0],c+t[1]]}function re(e,t,s,i){let r=Math.sin(i),o=Math.cos(i),a=t[0]-s[0],l=t[1]-s[1],c=a*o-l*r,u=a*r+l*o;return e[0]=c+s[0],e[1]=u+s[1],e}function ae(e,t,s){return q(e,X(V(t,e),s))}function qe(e,t,s,i){let r=s[0]-t[0],o=s[1]-t[1];return e[0]=t[0]+r*i,e[1]=t[1]+o*i,e}function le(e,t,s){return q(e,X(t,s))}const L=[0,0],J=[0,0],Z=[0,0];function Be(e,t){let s=le(e,oe(ne(V(e,q(e,[1,1])))),-t),i=[],r=1/13;for(let o=r;o<=1;o+=r)i.push(Rt(s,e,pt*2*o));return i}function Ue(e,t,s){let i=[],r=1/s;for(let o=r;o<=1;o+=r)i.push(Rt(t,e,pt*o));return i}function We(e,t,s){let i=V(t,s),r=X(i,.5),o=X(i,.51);return[V(e,r),V(e,o),q(e,o),q(e,r)]}function Ge(e,t,s,i){let r=[],o=le(e,t,s),a=1/i;for(let l=a;l<1;l+=a)r.push(Rt(o,e,pt*3*l));return r}function Ke(e,t,s){return[q(e,X(t,s)),q(e,X(t,s*.99)),V(e,X(t,s*.99)),V(e,X(t,s))]}function ce(e,t,s){return e===!1||e===void 0?0:e===!0?Math.max(t,s):e}function Fe(e,t,s){return e.slice(0,10).reduce((i,r)=>{let o=r.pressure;return t&&(o=te(i,r.distance,s)),(i+o)/2},e[0].pressure)}function Ye(e,t={}){let{size:s=16,smoothing:i=.5,thinning:r=.5,simulatePressure:o=!0,easing:a=y=>y,start:l={},end:c={},last:u=!1}=t,{cap:x=!0,easing:O=y=>y*(2-y)}=l,{cap:m=!0,easing:E=y=>--y*y*y+1}=c;if(e.length===0||s<=0)return[];let N=e[e.length-1].runningLength,U=ce(l.taper,s,N),P=ce(c.taper,s,N),F=(s*i)**2,S=[],H=[],vt=Fe(e,o,s),I=Qt(s,r,e[e.length-1].pressure,a),ot,xt=e[0].vector,g=e[0].point,j=g,W=g,G=j,qt=!1;for(let y=0;y<e.length;y++){let{pressure:Gt}=e[y],{point:rt,vector:yt,distance:fn,runningLength:kt}=e[y],At=y===e.length-1;if(!At&&N-kt<3)continue;r?(o&&(Gt=te(vt,fn,s)),I=Qt(s,r,Gt,a)):I=s/2,ot===void 0&&(ot=I);let mn=kt<U?O(kt/U):1,gn=N-kt<P?E((N-kt)/P):1;I=Math.max(.01,I*Math.min(mn,gn));let ve=(At?e[y]:e[y+1]).vector,Kt=At?1:se(yt,ve),vn=se(yt,xt)<0&&!qt,xe=Kt!==null&&Kt<0;if(vn||xe){It(L,xt),Pt(L,L,I);for(let Nt=0;Nt<=1;Nt+=.07692307692307693)Tt(J,rt,L),re(J,J,rt,pt*Nt),W=[J[0],J[1]],S.push(W),ee(Z,rt,L),re(Z,Z,rt,pt*-Nt),G=[Z[0],Z[1]],H.push(G);g=W,j=G,xe&&(qt=!0);continue}if(qt=!1,At){It(L,yt),Pt(L,L,I),S.push(V(rt,L)),H.push(q(rt,L));continue}qe(L,ve,yt,Kt),It(L,L),Pt(L,L,I),Tt(J,rt,L),W=[J[0],J[1]],(y<=1||ie(g,W)>F)&&(S.push(W),g=W),ee(Z,rt,L),G=[Z[0],Z[1]],(y<=1||ie(j,G)>F)&&(H.push(G),j=G),vt=Gt,xt=yt}let Bt=[e[0].point[0],e[0].point[1]],Ut=e.length>1?[e[e.length-1].point[0],e[e.length-1].point[1]]:q(e[0].point,[1,1]),Wt=[],St=[];if(e.length===1){if(!(U||P)||u)return Be(Bt,ot||I)}else{U||P&&e.length===1||(x?Wt.push(...Ue(Bt,H[0],13)):Wt.push(...We(Bt,S[0],H[0])));let y=ne(Re(e[e.length-1].vector));P||U&&e.length===1?St.push(Ut):m?St.push(...Ge(Ut,y,I,29)):St.push(...Ke(Ut,y,I))}return S.concat(St,H.reverse(),Wt)}const de=[0,0];function ue(e){return e!=null&&e>=0}function Ve(e,t={}){let{streamline:s=.5,size:i=16,last:r=!1}=t;if(e.length===0)return[];let o=.15+(1-s)*.85,a=Array.isArray(e[0])?e:e.map(({x:m,y:E,pressure:N=Jt})=>[m,E,N]);if(a.length===2){let m=a[1];a=a.slice(0,-1);for(let E=1;E<5;E++)a.push(ae(a[0],m,E/4))}a.length===1&&(a=[...a,[...q(a[0],Zt),...a[0].slice(2)]]);let l=[{point:[a[0][0],a[0][1]],pressure:ue(a[0][2])?a[0][2]:.25,vector:[...Zt],distance:0,runningLength:0}],c=!1,u=0,x=l[0],O=a.length-1;for(let m=1;m<a.length;m++){let E=r&&m===O?[a[m][0],a[m][1]]:ae(x.point,a[m],o);if(Oe(x.point,E))continue;let N=je(E,x.point);if(u+=N,m<O&&!c){if(u<i)continue;c=!0}Tt(de,x.point,E),x={point:E,pressure:ue(a[m][2])?a[m][2]:Jt,vector:oe(de),distance:N,runningLength:u},l.push(x)}return l[0].vector=l[1]?.vector||[0,0],l}function Xe(e,t={}){return Ye(Ve(e,t),t)}var Je=Xe;function Ze(e){if(e.length<2)return"";const t=[];t.push(`M ${Math.round(e[0][0])} ${Math.round(e[0][1])}`);for(let i=1;i<e.length-1;i++){const r=Math.round((e[i][0]+e[i+1][0])/2),o=Math.round((e[i][1]+e[i+1][1])/2);t.push(`Q ${Math.round(e[i][0])} ${Math.round(e[i][1])} ${r} ${o}`)}const s=e[e.length-1];return t.push(`L ${Math.round(s[0])} ${Math.round(s[1])}`),t.push("Z"),t.join(" ")}function he(e){const{width:t,height:s,strokes:i}=e,r=i.map(o=>{const a=Je(o.points.map(([c,u,x])=>[c,u,x]),{size:o.size,thinning:.5,smoothing:.5,streamline:.5,simulatePressure:!0});return`<path d="${Ze(a)}" fill="${o.color}" />`});return[`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 ${t} ${s}" width="${t}" height="${s}">`,...r,"</svg>"].join("")}function Qe(e){const t=he(e);return`data:image/svg+xml;charset=utf-8,${encodeURIComponent(t)}`}const Dt=12;function tn(e){return e<480?1:e<768?2:e<1024?3:4}function pe(e,t){const s=e.offsetWidth;if(!s||t.length===0)return;const i=tn(s),r=(s-Dt*(i-1))/i,o=new Array(i).fill(0);for(const a of t){a.style.position="absolute",a.style.width=`${r}px`;let l=0;for(let x=1;x<i;x++)o[x]<o[l]&&(l=x);const c=l*(r+Dt),u=o[l];a.style.transform=`translate(${Math.round(c)}px, ${Math.round(u)}px)`,o[l]+=a.offsetHeight+Dt}e.style.height=`${Math.max(...o)}px`}function en(e,t){let s=null;const i=new ResizeObserver(()=>{s&&clearTimeout(s),s=setTimeout(()=>{pe(e,t())},150)});return i.observe(e),i}const nn=".sb-root{font-family:var(--sb-font, system-ui, sans-serif);color:var(--sb-text, #1a1a1a);box-sizing:border-box;position:relative}.sb-root *,.sb-root *:before,.sb-root *:after{box-sizing:border-box}.sb-skeleton{display:flex;gap:12px;padding:16px 0}.sb-skeleton-card{flex:1;height:120px;border-radius:var(--sb-card-radius, 12px);background:linear-gradient(90deg,#f0f0f0 25%,#e0e0e0,#f0f0f0 75%);background-size:200% 100%;animation:sb-shimmer 1.5s ease-in-out infinite}@keyframes sb-shimmer{0%{background-position:200% 0}to{background-position:-200% 0}}.sb-wall{position:relative;width:100%;padding:8px 0}.sb-empty{text-align:center;padding:48px 16px}.sb-empty-text{font-size:18px;color:var(--sb-text, #1a1a1a);opacity:.6;margin:0}.sb-card{position:relative;background:var(--sb-card-bg, #ffffff);border-radius:var(--sb-card-radius, 12px);padding:12px;box-shadow:0 1px 3px #00000014;transition:opacity .3s ease;animation:sb-fadeIn .4s ease}@keyframes sb-fadeIn{0%{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}.sb-card-img{width:100%;height:auto;display:block;border-radius:6px}.sb-card-name{margin:8px 0 0;font-size:14px;font-weight:600}.sb-card-message{margin:4px 0 0;font-size:12px;opacity:.7}.sb-card-link{display:inline-block;margin-top:4px;font-size:12px;color:var(--sb-accent, #6366f1);text-decoration:none}.sb-link-icon{font-size:14px}.sb-overflow{text-align:center;padding:16px;font-size:13px;opacity:.6}.sb-sentinel{height:1px;width:100%}.sb-cta{display:block;margin:16px auto;padding:12px 28px;font-size:16px;font-weight:600;font-family:var(--sb-font, system-ui, sans-serif);color:#fff;background:var(--sb-accent, #6366f1);border:none;border-radius:9999px;cursor:pointer;transition:transform .15s ease,box-shadow .15s ease}.sb-cta:hover{transform:translateY(-1px);box-shadow:0 4px 12px #00000026}.sb-cta:active{transform:translateY(0)}.sb-modal-backdrop{position:fixed;inset:0;z-index:999999;background:#00000080;display:flex;align-items:center;justify-content:center;padding:16px}.sb-modal{background:#fff;border-radius:16px;width:100%;max-width:460px;max-height:90vh;overflow-y:auto;overscroll-behavior-y:contain;padding:24px;position:relative;box-shadow:0 20px 60px #0000004d}.sb-modal-close{position:absolute;top:12px;right:12px;width:32px;height:32px;border:none;background:none;font-size:24px;cursor:pointer;color:#6b7280;border-radius:6px;display:flex;align-items:center;justify-content:center}.sb-modal-close:hover{background:#f3f4f6}.sb-modal-title{margin:0 0 16px;font-size:20px;font-weight:700}.sb-canvas-area{position:relative;border:2px solid #e5e7eb;border-radius:12px;overflow:hidden;touch-action:none}.sb-canvas{display:block;cursor:crosshair;width:100%;height:auto}.sb-canvas-preview{position:absolute;inset:0;pointer-events:none}.sb-canvas-preview svg{width:100%;height:100%}.sb-toolbar{display:flex;flex-wrap:wrap;gap:8px;margin:12px 0;align-items:center}.sb-color-row{display:flex;gap:4px}.sb-color-btn{width:24px;height:24px;border-radius:50%;border:2px solid transparent;cursor:pointer;padding:0;transition:border-color .15s}.sb-color-btn.sb-active{border-color:var(--sb-accent, #6366f1)}.sb-size-row{display:flex;gap:4px;margin-left:auto}.sb-size-btn,.sb-action-btn{padding:4px 10px;font-size:12px;border:1px solid #d1d5db;background:#fff;border-radius:6px;cursor:pointer}.sb-size-btn.sb-active{background:var(--sb-accent, #6366f1);color:#fff;border-color:var(--sb-accent, #6366f1)}.sb-action-row{display:flex;gap:4px}.sb-action-btn:hover{background:#f3f4f6}.sb-form{display:flex;flex-direction:column;gap:12px}.sb-field{display:flex;flex-direction:column}.sb-label{font-size:13px;font-weight:500;margin-bottom:4px;display:flex;flex-direction:column;gap:4px}.sb-input{padding:8px 12px;font-size:14px;border:1px solid #d1d5db;border-radius:8px;outline:none;font-family:inherit}.sb-input:focus{border-color:var(--sb-accent, #6366f1);box-shadow:0 0 0 2px #6366f133}.sb-error{color:#dc2626;font-size:13px;margin:0}.sb-submit{padding:12px;font-size:15px;font-weight:600;color:#fff;background:var(--sb-accent, #6366f1);border:none;border-radius:10px;cursor:pointer;transition:opacity .15s}.sb-submit:disabled{opacity:.5;cursor:not-allowed}.sb-submit:not(:disabled):hover{opacity:.9}.sb-success{text-align:center;padding:48px 16px}.sb-success-text{font-size:20px;font-weight:600;color:#16a34a;margin:0}.sb-branding{text-align:center;padding:12px 0 4px;font-size:11px;color:#a3a3a3}.sb-branding a{color:inherit;text-decoration:none}.sb-branding a:hover{color:#737373;text-decoration:underline}.sb-remove-btn{position:absolute;top:6px;right:6px;background:#0000000d;border:none;border-radius:4px;padding:2px 6px;font-size:10px;color:#a3a3a3;cursor:pointer;opacity:0;transition:opacity .15s}.sb-card:hover .sb-remove-btn{opacity:1}.sb-remove-btn:hover{background:#ef44441a;color:#ef4444}",Mt=100,sn=3e4;class be{constructor(t,s){h(this,p);h(this,_t);h(this,Q);h(this,v);h(this,R);h(this,tt,null);h(this,z,[]);h(this,$,null);h(this,B,!0);h(this,at,!1);h(this,dt,null);h(this,ut,null);h(this,w,null);h(this,lt,null);d(this,_t,t),d(this,R,s),d(this,Q,t.attachShadow({mode:"open"}));const i=document.createElement("style");i.textContent=nn,n(this,Q).appendChild(i),d(this,v,document.createElement("div")),n(this,v).className="sb-root",n(this,v).setAttribute("role","region"),n(this,v).setAttribute("aria-label","Guestbook"),n(this,Q).appendChild(n(this,v)),f(this,p,we).call(this),f(this,p,ke).call(this)}destroy(){n(this,dt)&&clearInterval(n(this,dt)),n(this,ut)?.disconnect(),n(this,lt)?.disconnect(),n(this,Q).innerHTML=""}}_t=new WeakMap,Q=new WeakMap,v=new WeakMap,R=new WeakMap,tt=new WeakMap,z=new WeakMap,$=new WeakMap,B=new WeakMap,at=new WeakMap,dt=new WeakMap,ut=new WeakMap,w=new WeakMap,lt=new WeakMap,p=new WeakSet,ke=async function(){const[t,s]=await Promise.all([$e(n(this,R)),Lt(n(this,R))]);if(!t.ok){f(this,p,Ee).call(this);return}d(this,tt,t.data),s.ok&&s.data&&(d(this,z,s.data.entries),d(this,$,s.data.cursor),d(this,B,n(this,$)!==null)),f(this,p,Ce).call(this),f(this,p,Ae).call(this)},we=function(){n(this,v).innerHTML=`
      <div class="sb-skeleton">
        <div class="sb-skeleton-card"></div>
        <div class="sb-skeleton-card"></div>
        <div class="sb-skeleton-card"></div>
      </div>
    `,n(this,v).style.minHeight="200px"},Ee=function(){n(this,v).innerHTML="",n(this,v).style.minHeight="0"},Ce=function(){if(!n(this,tt))return;const t=n(this,tt).settings;n(this,v).innerHTML="",n(this,v).style.setProperty("--sb-bg",t.background_color),n(this,v).style.setProperty("--sb-card-bg",t.card_background_color),n(this,v).style.setProperty("--sb-text",t.text_color),n(this,v).style.setProperty("--sb-accent",t.accent_color),n(this,v).style.setProperty("--sb-card-radius",`${t.card_border_radius}px`),n(this,v).style.setProperty("--sb-font",t.font==="handwriting"?'"Caveat", cursive':t.font==="mono"?"monospace":"system-ui, sans-serif"),n(this,v).style.backgroundColor=t.widget_transparent_bg?"transparent":t.background_color,d(this,w,document.createElement("div")),n(this,w).className="sb-wall",n(this,w).setAttribute("role","list"),n(this,w).setAttribute("aria-label","Guestbook entries"),n(this,v).appendChild(n(this,w)),n(this,z).length===0?f(this,p,Le).call(this):f(this,p,wt).call(this);const s=document.createElement("button");if(s.className="sb-cta",s.textContent=t.cta_text,s.setAttribute("aria-label",t.cta_text),s.addEventListener("click",()=>f(this,p,Ne).call(this)),n(this,v).appendChild(s),n(this,tt).branding){const i=document.createElement("a");i.className="sb-branding",i.href="https://guestbook.cv",i.target="_blank",i.rel="noopener noreferrer",i.textContent="Powered by Guestbook",n(this,v).appendChild(i)}},Le=function(){n(this,w)&&(n(this,w).innerHTML=`
      <div class="sb-empty">
        <p class="sb-empty-text">Be the first to sign!</p>
      </div>
    `)},wt=function(){if(!n(this,w))return;n(this,w).innerHTML="";const t=Math.min(n(this,z).length,Mt),s=[];for(let i=0;i<t;i++){const r=n(this,z)[i],o=f(this,p,Me).call(this,r);n(this,w).appendChild(o),s.push(o)}if(n(this,z).length>Mt){const i=document.createElement("div");i.className="sb-overflow",i.textContent=`+ ${n(this,z).length-Mt} more entries`,n(this,w).appendChild(i)}requestAnimationFrame(()=>{n(this,w)&&(pe(n(this,w),s),n(this,ut)?.disconnect(),d(this,ut,en(n(this,w),()=>Array.from(n(this,w).querySelectorAll(".sb-card")))))}),n(this,B)&&t<Mt&&f(this,p,_e).call(this)},Me=function(t){const s=document.createElement("div");s.className="sb-card",s.setAttribute("role","listitem");const i=t.stroke_data,r=Qe(i),o=document.createElement("img");o.src=r,o.width=i.width,o.height=i.height,o.alt=`Drawing by ${t.name}`,o.className="sb-card-img",o.loading="lazy",s.appendChild(o);const a=document.createElement("p");if(a.className="sb-card-name",a.textContent=t.name,s.appendChild(a),t.message){const l=document.createElement("p");l.className="sb-card-message",l.textContent=t.message,s.appendChild(l)}if(t.link){const l=document.createElement("a");l.href=t.link,l.target="_blank",l.rel="noopener noreferrer",l.className="sb-card-link",l.setAttribute("aria-label",`Visit ${t.name}'s link`);const c=document.createElement("span");c.className="sb-link-icon",c.textContent="↗",l.appendChild(c),s.appendChild(l)}try{const l=localStorage.getItem(`sb_del_${t.id}`);if(l){const c=document.createElement("button");c.className="sb-remove-btn",c.textContent="Remove",c.setAttribute("aria-label","Remove your entry"),c.addEventListener("click",async u=>{u.stopPropagation(),c.disabled=!0,c.textContent="Removing...",(await Pe(n(this,R),t.id,l)).ok?(localStorage.removeItem(`sb_del_${t.id}`),f(this,p,Yt).call(this)):(c.disabled=!1,c.textContent="Remove")}),s.appendChild(c)}}catch{}return s},_e=function(){const t=document.createElement("div");t.className="sb-sentinel",n(this,w)?.appendChild(t),n(this,lt)?.disconnect(),d(this,lt,new IntersectionObserver(async s=>{s[0]?.isIntersecting&&n(this,B)&&!n(this,at)&&await f(this,p,Se).call(this)},{rootMargin:"200px"})),n(this,lt).observe(t)},Se=async function(){if(n(this,at)||!n(this,B)||!n(this,$))return;d(this,at,!0);const t=await Lt(n(this,R),n(this,$));t.ok&&t.data&&(n(this,z).push(...t.data.entries),d(this,$,t.data.cursor),d(this,B,n(this,$)!==null),f(this,p,wt).call(this)),d(this,at,!1)},Ae=function(){d(this,dt,setInterval(async()=>{if(document.hidden)return;const t=await Lt(n(this,R));if(t.ok&&t.data&&t.data.entries.length>0){const s=n(this,z)[0]?.id,i=t.data.entries[0]?.id;s!==i&&(d(this,z,t.data.entries),d(this,$,t.data.cursor),d(this,B,n(this,$)!==null),f(this,p,wt).call(this))}},sn))},Ne=async function(){const{openModal:t}=await Promise.resolve().then(()=>bn);t(n(this,Q),n(this,R),n(this,tt),()=>{f(this,p,Yt).call(this)})},Yt=async function(){const t=await Lt(n(this,R));t.ok&&t.data&&(d(this,z,t.data.entries),d(this,$,t.data.cursor),d(this,B,n(this,$)!==null),f(this,p,wt).call(this))};function fe(){const e=document.querySelectorAll('script[src*="widget.js"]'),t=e[e.length-1];if(t?.src){const i=new URL(t.src);M(i.origin)}document.querySelectorAll("[data-sb-id]").forEach(i=>{const r=i.getAttribute("data-sb-id");r&&!i.shadowRoot&&new be(i,r)})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",fe):fe();const on=new MutationObserver(e=>{for(const t of e)for(const s of t.addedNodes)if(s instanceof HTMLElement&&s.hasAttribute("data-sb-id")&&!s.shadowRoot){const i=s.getAttribute("data-sb-id");i&&new be(s,i)}});let me=!1;function ge(){me||!document.body||(me=!0,on.observe(document.body,{childList:!0,subtree:!0}))}document.body?ge():document.addEventListener("DOMContentLoaded",ge,{once:!0});const rn=100,an=5e3,Ot=["#1a1a1a","#6b7280","#2563eb","#dc2626","#16a34a","#9333ea","#ea580c","#ec4899"],Ht=[{label:"Thin",value:4},{label:"Medium",value:8},{label:"Thick",value:14}];class ln{constructor(t,s,i,r){h(this,_);h(this,b);h(this,ht);h(this,D);h(this,A,[]);h(this,T,null);h(this,et,null);h(this,bt,Ot[0]);h(this,ft,Ht[1].value);h(this,nt);h(this,st);h(this,it);h(this,ct);h(this,mt,t=>{if(t.preventDefault(),n(this,et)!==null||n(this,A).length>=rn)return;d(this,et,t.pointerId),n(this,b).setPointerCapture(t.pointerId);const[s,i]=f(this,_,Vt).call(this,t);d(this,T,{points:[[s,i,t.pressure||.5]],color:n(this,bt),size:n(this,ft)})});h(this,gt,t=>{if(t.preventDefault(),t.pointerId!==n(this,et)||!n(this,T)||n(this,A).reduce((o,a)=>o+a.points.length,0)+n(this,T).points.length>=an)return;const[i,r]=f(this,_,Vt).call(this,t);n(this,T).points.push([i,r,t.pressure||.5]),f(this,_,zt).call(this)});h(this,K,t=>{t.pointerId===n(this,et)&&(d(this,et,null),n(this,T)&&n(this,T).points.length>1&&(n(this,A).push(n(this,T)),n(this,ct).call(this)),d(this,T,null),f(this,_,zt).call(this))});d(this,nt,s),d(this,st,i),d(this,ct,r),d(this,it,Math.min(window.devicePixelRatio||1,2)),d(this,b,document.createElement("canvas")),n(this,b).width=s*n(this,it),n(this,b).height=i*n(this,it),n(this,b).style.width=`${s}px`,n(this,b).style.height=`${i}px`,n(this,b).style.touchAction="none",n(this,b).className="sb-canvas",d(this,ht,n(this,b).getContext("2d")),n(this,ht).scale(n(this,it),n(this,it)),d(this,D,document.createElement("div")),n(this,D).className="sb-canvas-preview",n(this,D).style.display="none",t.appendChild(n(this,b)),t.appendChild(n(this,D)),f(this,_,ze).call(this),f(this,_,Et).call(this)}setColor(t){d(this,bt,t)}setSize(t){d(this,ft,t)}undo(){n(this,A).length!==0&&(n(this,A).pop(),n(this,ct).call(this),n(this,A).length===0?(n(this,D).style.display="none",n(this,b).style.opacity="1",f(this,_,Et).call(this)):f(this,_,zt).call(this))}clear(){d(this,A,[]),n(this,D).style.display="none",n(this,b).style.opacity="1",f(this,_,Et).call(this),n(this,ct).call(this)}isEmpty(){return n(this,A).length===0}getDrawingData(){return{version:1,width:n(this,nt),height:n(this,st),strokes:n(this,A).map(t=>({points:t.points.map(([s,i,r])=>[s,i,r]),color:t.color,size:t.size}))}}destroy(){n(this,b).removeEventListener("pointerdown",n(this,mt)),n(this,b).removeEventListener("pointermove",n(this,gt)),n(this,b).removeEventListener("pointerup",n(this,K)),n(this,b).removeEventListener("pointercancel",n(this,K)),n(this,b).removeEventListener("pointerleave",n(this,K))}}b=new WeakMap,ht=new WeakMap,D=new WeakMap,A=new WeakMap,T=new WeakMap,et=new WeakMap,bt=new WeakMap,ft=new WeakMap,nt=new WeakMap,st=new WeakMap,it=new WeakMap,ct=new WeakMap,_=new WeakSet,ze=function(){n(this,b).addEventListener("pointerdown",n(this,mt),{passive:!1}),n(this,b).addEventListener("pointermove",n(this,gt),{passive:!1}),n(this,b).addEventListener("pointerup",n(this,K)),n(this,b).addEventListener("pointercancel",n(this,K)),n(this,b).addEventListener("pointerleave",n(this,K))},mt=new WeakMap,gt=new WeakMap,K=new WeakMap,Vt=function(t){const s=n(this,b).getBoundingClientRect(),i=Math.round((t.clientX-s.left)/s.width*n(this,nt)),r=Math.round((t.clientY-s.top)/s.height*n(this,st));return[i,r]},Et=function(){n(this,ht).clearRect(0,0,n(this,nt),n(this,st))},zt=function(){f(this,_,Et).call(this);const t=n(this,T)?[...n(this,A),n(this,T)]:n(this,A);if(t.length===0)return;const s={width:n(this,nt),height:n(this,st),strokes:t},i=he(s);n(this,D).innerHTML=i,n(this,D).style.display="block",n(this,b).style.opacity="0"};function cn(e,t){const s=document.createElement("div");s.className="sb-toolbar";const i=document.createElement("div");i.className="sb-color-row",Ot.forEach(c=>{const u=document.createElement("button");u.className="sb-color-btn",u.style.backgroundColor=c,u.setAttribute("aria-label",`Pen color ${c}`),u.addEventListener("click",()=>{t.setColor(c),i.querySelectorAll(".sb-color-btn").forEach(x=>x.classList.remove("sb-active")),u.classList.add("sb-active")}),c===Ot[0]&&u.classList.add("sb-active"),i.appendChild(u)}),s.appendChild(i);const r=document.createElement("div");r.className="sb-size-row",Ht.forEach(c=>{const u=document.createElement("button");u.className="sb-size-btn",u.textContent=c.label,u.setAttribute("aria-label",`Pen size ${c.label}`),u.addEventListener("click",()=>{t.setSize(c.value),r.querySelectorAll(".sb-size-btn").forEach(x=>x.classList.remove("sb-active")),u.classList.add("sb-active")}),c.value===Ht[1].value&&u.classList.add("sb-active"),r.appendChild(u)}),s.appendChild(r);const o=document.createElement("div");o.className="sb-action-row";const a=document.createElement("button");a.className="sb-action-btn",a.textContent="Undo",a.setAttribute("aria-label","Undo last stroke"),a.addEventListener("click",()=>t.undo()),o.appendChild(a);const l=document.createElement("button");l.className="sb-action-btn",l.textContent="Clear",l.setAttribute("aria-label","Clear drawing"),l.addEventListener("click",()=>t.clear()),o.appendChild(l),s.appendChild(o),e.appendChild(s)}const dn=400,un=250,hn=300;function pn(e,t,s,i){const r=s.settings,o=document.createElement("div");o.className="sb-modal-backdrop",o.setAttribute("role","dialog"),o.setAttribute("aria-modal","true"),o.setAttribute("aria-label","Sign the guestbook");const a=document.createElement("div");a.className="sb-modal";const l=document.createElement("button");l.className="sb-modal-close",l.textContent="×",l.setAttribute("aria-label","Close"),a.appendChild(l);const c=document.createElement("h2");c.className="sb-modal-title",c.textContent=r.cta_text,a.appendChild(c);const u=document.createElement("div");u.className="sb-canvas-area",u.style.backgroundColor=r.canvas_background_color,a.appendChild(u);const x=window.innerWidth<768?hn:un,O=new ln(u,dn,x,()=>{vt()});cn(a,O);const m=document.createElement("div");m.className="sb-form";const E=jt("Your name *","name",!0,100);m.appendChild(E.wrapper);let N=null;r.show_message_field&&(N=jt("Message (optional)","message",!1,200),m.appendChild(N.wrapper));let U=null;r.show_link_field&&(U=jt("Link (optional)","link",!1,500,"url"),U.input.placeholder="https://...",m.appendChild(U.wrapper));const P=document.createElement("input");P.type="text",P.name="_hp",P.tabIndex=-1,P.autocomplete="off",P.style.cssText="position:absolute;left:-9999px;width:1px;height:1px;overflow:hidden",m.appendChild(P);const F=document.createElement("p");F.className="sb-error",F.style.display="none",m.appendChild(F);const S=document.createElement("button");S.className="sb-submit",S.textContent="Submit",S.disabled=!0,m.appendChild(S),a.appendChild(m),o.appendChild(a),e.appendChild(o),document.body.style.overflow="hidden",requestAnimationFrame(()=>E.input.focus());let H=!1;function vt(){S.disabled=O.isEmpty()||!E.input.value.trim()||H}E.input.addEventListener("input",vt);function I(g){(g.ctrlKey||g.metaKey)&&g.key==="z"&&(g.preventDefault(),O.undo()),g.key==="Escape"&&ot()}o.addEventListener("keydown",I);function ot(){O.destroy(),document.body.style.overflow="",o.remove()}l.addEventListener("click",ot),o.addEventListener("click",g=>{g.target===o&&ot()}),S.addEventListener("click",async()=>{if(H||O.isEmpty()||!E.input.value.trim())return;H=!0,S.disabled=!0,S.textContent="Submitting...",F.style.display="none";const g=await Te(t,{name:E.input.value.trim(),message:N?.input.value.trim()||void 0,link:U?.input.value.trim()||void 0,stroke_data:O.getDrawingData(),_hp:P.value||void 0});if(g.ok){try{const j=`sb_del_${g.data.id}`;localStorage.setItem(j,g.data.deletion_token)}catch{}a.innerHTML=`
        <div class="sb-success">
          <p class="sb-success-text">Thanks for signing!</p>
        </div>
      `,setTimeout(()=>{ot(),i()},1500)}else H=!1,S.disabled=!1,S.textContent="Submit",F.textContent=g.error.error||"Something went wrong",F.style.display="block"});const xt='button, input, [tabindex]:not([tabindex="-1"])';o.addEventListener("keydown",g=>{if(g.key!=="Tab")return;const j=Array.from(a.querySelectorAll(xt));if(j.length===0)return;const W=j[0],G=j[j.length-1];g.shiftKey&&document.activeElement===W?(g.preventDefault(),G.focus()):!g.shiftKey&&document.activeElement===G&&(g.preventDefault(),W.focus())})}function jt(e,t,s,i,r="text"){const o=document.createElement("div");o.className="sb-field";const a=document.createElement("label");a.className="sb-label",a.textContent=e;const l=document.createElement("input");return l.type=r,l.name=t,l.required=s,l.maxLength=i,l.className="sb-input",l.autocomplete="off",a.appendChild(l),o.appendChild(a),{wrapper:o,input:l}}const bn=Object.freeze(Object.defineProperty({__proto__:null,openModal:pn},Symbol.toStringTag,{value:"Module"}))})();
