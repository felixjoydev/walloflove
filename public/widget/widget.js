var me=w=>{throw TypeError(w)};var Wt=(w,C,N)=>C.has(w)||me("Cannot "+N);var n=(w,C,N)=>(Wt(w,C,"read from private field"),N?N.call(w):C.get(w)),h=(w,C,N)=>C.has(w)?me("Cannot add the same private member more than once"):C instanceof WeakSet?C.add(w):C.set(w,N),d=(w,C,N,it)=>(Wt(w,C,"write to private field"),it?it.call(w,N):C.set(w,N),N),m=(w,C,N)=>(Wt(w,C,"access private method"),N);(function(){"use strict";var Lt,J,g,H,Z,A,$,q,ot,dt,ut,k,rt,p,ge,ve,xe,ye,we,wt,ke,Ee,Ce,Le,Me,Yt,b,ht,j,_,T,Q,bt,ft,tt,et,nt,at,L,Se,mt,gt,K,Gt,kt,_t;let w="";function C(e){w=e.replace(/\/$/,"")}const N=new Map;async function it(e,t){const s=`${w}${e}`,i={"Content-Type":"application/json"};if(t?.useEtag){const r=N.get(e);r&&(i["If-None-Match"]=r)}try{const r=await fetch(s,{...t,headers:{...i,...t?.headers}});if(r.status===304)return{ok:!0,data:null};if(!r.ok)return{ok:!1,error:await r.json().catch(()=>({error:r.statusText}))};if(t?.useEtag){const a=r.headers.get("ETag");a&&N.set(e,a)}return{ok:!0,data:await r.json()}}catch{return{ok:!1,error:{error:"Network error"}}}}function Ne(e){return it(`/api/v1/guestbooks/${e}`)}function Et(e,t){const s=t?`?cursor=${encodeURIComponent(t)}`:"";return it(`/api/v1/guestbooks/${e}/entries${s}`,{useEtag:!t})}function ze(e,t){return it(`/api/v1/guestbooks/${e}/entries`,{method:"POST",body:JSON.stringify(t)})}function _e(e,t,s){return it(`/api/v1/guestbooks/${e}/entries/${t}`,{method:"DELETE",body:JSON.stringify({deletion_token:s})})}const{PI:Ae}=Math,pt=Ae+1e-4,Vt=.5,Xt=[1,1];function Jt(e,t,s,i=r=>r){return e*i(.5-t*(.5-s))}const{min:At}=Math;function Zt(e,t,s){let i=At(1,t/s);return At(1,e+(At(1,1-i)-e)*(i*.275))}function $e(e){return[-e[0],-e[1]]}function B(e,t){return[e[0]+t[0],e[1]+t[1]]}function Qt(e,t,s){return e[0]=t[0]+s[0],e[1]=t[1]+s[1],e}function Y(e,t){return[e[0]-t[0],e[1]-t[1]]}function $t(e,t,s){return e[0]=t[0]-s[0],e[1]=t[1]-s[1],e}function G(e,t){return[e[0]*t,e[1]*t]}function Tt(e,t,s){return e[0]=t[0]*s,e[1]=t[1]*s,e}function Te(e,t){return[e[0]/t,e[1]/t]}function te(e){return[e[1],-e[0]]}function Pt(e,t){let s=t[0];return e[0]=t[1],e[1]=-s,e}function ee(e,t){return e[0]*t[0]+e[1]*t[1]}function Pe(e,t){return e[0]===t[0]&&e[1]===t[1]}function Ie(e){return Math.hypot(e[0],e[1])}function ne(e,t){let s=e[0]-t[0],i=e[1]-t[1];return s*s+i*i}function se(e){return Te(e,Ie(e))}function Re(e,t){return Math.hypot(e[1]-t[1],e[0]-t[0])}function It(e,t,s){let i=Math.sin(s),r=Math.cos(s),o=e[0]-t[0],a=e[1]-t[1],l=o*r-a*i,c=o*i+a*r;return[l+t[0],c+t[1]]}function ie(e,t,s,i){let r=Math.sin(i),o=Math.cos(i),a=t[0]-s[0],l=t[1]-s[1],c=a*o-l*r,u=a*r+l*o;return e[0]=c+s[0],e[1]=u+s[1],e}function oe(e,t,s){return B(e,G(Y(t,e),s))}function De(e,t,s,i){let r=s[0]-t[0],o=s[1]-t[1];return e[0]=t[0]+r*i,e[1]=t[1]+o*i,e}function re(e,t,s){return B(e,G(t,s))}const E=[0,0],V=[0,0],X=[0,0];function Oe(e,t){let s=re(e,se(te(Y(e,B(e,[1,1])))),-t),i=[],r=1/13;for(let o=r;o<=1;o+=r)i.push(It(s,e,pt*2*o));return i}function He(e,t,s){let i=[],r=1/s;for(let o=r;o<=1;o+=r)i.push(It(t,e,pt*o));return i}function je(e,t,s){let i=Y(t,s),r=G(i,.5),o=G(i,.51);return[Y(e,r),Y(e,o),B(e,o),B(e,r)]}function Be(e,t,s,i){let r=[],o=re(e,t,s),a=1/i;for(let l=a;l<1;l+=a)r.push(It(o,e,pt*3*l));return r}function qe(e,t,s){return[B(e,G(t,s)),B(e,G(t,s*.99)),Y(e,G(t,s*.99)),Y(e,G(t,s))]}function ae(e,t,s){return e===!1||e===void 0?0:e===!0?Math.max(t,s):e}function Ue(e,t,s){return e.slice(0,10).reduce((i,r)=>{let o=r.pressure;return t&&(o=Zt(i,r.distance,s)),(i+o)/2},e[0].pressure)}function Fe(e,t={}){let{size:s=16,smoothing:i=.5,thinning:r=.5,simulatePressure:o=!0,easing:a=y=>y,start:l={},end:c={},last:u=!1}=t,{cap:f=!0,easing:P=y=>y*(2-y)}=l,{cap:v=!0,easing:M=y=>--y*y*y+1}=c;if(e.length===0||s<=0)return[];let z=e[e.length-1].runningLength,I=ae(l.taper,s,z),D=ae(c.taper,s,z),R=(s*i)**2,U=[],W=[],Mt=Ue(e,o,s),S=Jt(s,r,e[e.length-1].pressure,a),vt,x=e[0].vector,O=e[0].point,lt=O,F=O,ct=lt,jt=!1;for(let y=0;y<e.length;y++){let{pressure:Ft}=e[y],{point:st,vector:xt,distance:cn,runningLength:yt}=e[y],Nt=y===e.length-1;if(!Nt&&z-yt<3)continue;r?(o&&(Ft=Zt(Mt,cn,s)),S=Jt(s,r,Ft,a)):S=s/2,vt===void 0&&(vt=S);let dn=yt<I?P(yt/I):1,un=z-yt<D?M((z-yt)/D):1;S=Math.max(.01,S*Math.min(dn,un));let be=(Nt?e[y]:e[y+1]).vector,Kt=Nt?1:ee(xt,be),hn=ee(xt,x)<0&&!jt,fe=Kt!==null&&Kt<0;if(hn||fe){Pt(E,x),Tt(E,E,S);for(let zt=0;zt<=1;zt+=.07692307692307693)$t(V,st,E),ie(V,V,st,pt*zt),F=[V[0],V[1]],U.push(F),Qt(X,st,E),ie(X,X,st,pt*-zt),ct=[X[0],X[1]],W.push(ct);O=F,lt=ct,fe&&(jt=!0);continue}if(jt=!1,Nt){Pt(E,xt),Tt(E,E,S),U.push(Y(st,E)),W.push(B(st,E));continue}De(E,be,xt,Kt),Pt(E,E),Tt(E,E,S),$t(V,st,E),F=[V[0],V[1]],(y<=1||ne(O,F)>R)&&(U.push(F),O=F),Qt(X,st,E),ct=[X[0],X[1]],(y<=1||ne(lt,ct)>R)&&(W.push(ct),lt=ct),Mt=Ft,x=xt}let Bt=[e[0].point[0],e[0].point[1]],qt=e.length>1?[e[e.length-1].point[0],e[e.length-1].point[1]]:B(e[0].point,[1,1]),Ut=[],St=[];if(e.length===1){if(!(I||D)||u)return Oe(Bt,vt||S)}else{I||D&&e.length===1||(f?Ut.push(...He(Bt,W[0],13)):Ut.push(...je(Bt,U[0],W[0])));let y=te($e(e[e.length-1].vector));D||I&&e.length===1?St.push(qt):v?St.push(...Be(qt,y,S,29)):St.push(...qe(qt,y,S))}return U.concat(St,W.reverse(),Ut)}const le=[0,0];function ce(e){return e!=null&&e>=0}function Ke(e,t={}){let{streamline:s=.5,size:i=16,last:r=!1}=t;if(e.length===0)return[];let o=.15+(1-s)*.85,a=Array.isArray(e[0])?e:e.map(({x:v,y:M,pressure:z=Vt})=>[v,M,z]);if(a.length===2){let v=a[1];a=a.slice(0,-1);for(let M=1;M<5;M++)a.push(oe(a[0],v,M/4))}a.length===1&&(a=[...a,[...B(a[0],Xt),...a[0].slice(2)]]);let l=[{point:[a[0][0],a[0][1]],pressure:ce(a[0][2])?a[0][2]:.25,vector:[...Xt],distance:0,runningLength:0}],c=!1,u=0,f=l[0],P=a.length-1;for(let v=1;v<a.length;v++){let M=r&&v===P?[a[v][0],a[v][1]]:oe(f.point,a[v],o);if(Pe(f.point,M))continue;let z=Re(M,f.point);if(u+=z,v<P&&!c){if(u<i)continue;c=!0}$t(le,f.point,M),f={point:M,pressure:ce(a[v][2])?a[v][2]:Vt,vector:se(le),distance:z,runningLength:u},l.push(f)}return l[0].vector=l[1]?.vector||[0,0],l}function We(e,t={}){return Fe(Ke(e,t),t)}var Ye=We;function Ge(e){if(e.length<2)return"";const t=[];t.push(`M ${Math.round(e[0][0])} ${Math.round(e[0][1])}`);for(let i=1;i<e.length-1;i++){const r=Math.round((e[i][0]+e[i+1][0])/2),o=Math.round((e[i][1]+e[i+1][1])/2);t.push(`Q ${Math.round(e[i][0])} ${Math.round(e[i][1])} ${r} ${o}`)}const s=e[e.length-1];return t.push(`L ${Math.round(s[0])} ${Math.round(s[1])}`),t.push("Z"),t.join(" ")}function de(e){const{width:t,height:s,strokes:i}=e,r=i.map(o=>{const a=Ye(o.points.map(([c,u,f])=>[c,u,f]),{size:o.size,thinning:.5,smoothing:.5,streamline:.5,simulatePressure:!0});return`<path d="${Ge(a)}" fill="${o.color}" />`});return[`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 ${t} ${s}" width="${t}" height="${s}">`,...r,"</svg>"].join("")}function Ve(e){const t=de(e);return`data:image/svg+xml;charset=utf-8,${encodeURIComponent(t)}`}const Rt=12;function Xe(e){return e<480?1:e<768?2:e<1024?3:4}function ue(e,t){const s=e.offsetWidth;if(!s||t.length===0)return;const i=Xe(s),r=(s-Rt*(i-1))/i,o=new Array(i).fill(0);for(const a of t){a.style.position="absolute",a.style.width=`${r}px`;let l=0;for(let f=1;f<i;f++)o[f]<o[l]&&(l=f);const c=l*(r+Rt),u=o[l];a.style.transform=`translate(${Math.round(c)}px, ${Math.round(u)}px)`,o[l]+=a.offsetHeight+Rt}e.style.height=`${Math.max(...o)}px`}function Je(e,t){let s=null;const i=new ResizeObserver(()=>{s&&clearTimeout(s),s=setTimeout(()=>{ue(e,t())},150)});return i.observe(e),i}const Ze=".sb-root{font-family:var(--sb-font, system-ui, sans-serif);color:var(--sb-text, #1a1a1a);box-sizing:border-box;position:relative}.sb-root *,.sb-root *:before,.sb-root *:after{box-sizing:border-box}.sb-skeleton{display:flex;gap:12px;padding:16px 0}.sb-skeleton-card{flex:1;height:120px;border-radius:var(--sb-card-radius, 12px);background:linear-gradient(90deg,#f0f0f0 25%,#e0e0e0,#f0f0f0 75%);background-size:200% 100%;animation:sb-shimmer 1.5s ease-in-out infinite}@keyframes sb-shimmer{0%{background-position:200% 0}to{background-position:-200% 0}}.sb-wall{position:relative;width:100%;padding:8px 0}.sb-empty{text-align:center;padding:48px 16px}.sb-empty-text{font-size:18px;color:var(--sb-text, #1a1a1a);opacity:.6;margin:0}.sb-card{position:relative;background:var(--sb-card-bg, #ffffff);border-radius:var(--sb-card-radius, 12px);padding:12px;box-shadow:0 1px 3px #00000014;transition:opacity .3s ease;animation:sb-fadeIn .4s ease}@keyframes sb-fadeIn{0%{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}.sb-card-img{width:100%;height:auto;display:block;border-radius:6px}.sb-card-name{margin:8px 0 0;font-size:14px;font-weight:600}.sb-card-message{margin:4px 0 0;font-size:12px;opacity:.7}.sb-card-link{display:inline-block;margin-top:4px;font-size:12px;color:var(--sb-accent, #6366f1);text-decoration:none}.sb-link-icon{font-size:14px}.sb-overflow{text-align:center;padding:16px;font-size:13px;opacity:.6}.sb-sentinel{height:1px;width:100%}.sb-cta{display:block;margin:16px auto;padding:12px 28px;font-size:16px;font-weight:600;font-family:var(--sb-font, system-ui, sans-serif);color:#fff;background:var(--sb-accent, #6366f1);border:none;border-radius:9999px;cursor:pointer;transition:transform .15s ease,box-shadow .15s ease}.sb-cta:hover{transform:translateY(-1px);box-shadow:0 4px 12px #00000026}.sb-cta:active{transform:translateY(0)}.sb-modal-backdrop{position:fixed;inset:0;z-index:999999;background:#00000080;display:flex;align-items:center;justify-content:center;padding:16px}.sb-modal{background:#fff;border-radius:16px;width:100%;max-width:460px;max-height:90vh;overflow-y:auto;padding:24px;position:relative;box-shadow:0 20px 60px #0000004d}.sb-modal-close{position:absolute;top:12px;right:12px;width:32px;height:32px;border:none;background:none;font-size:24px;cursor:pointer;color:#6b7280;border-radius:6px;display:flex;align-items:center;justify-content:center}.sb-modal-close:hover{background:#f3f4f6}.sb-modal-title{margin:0 0 16px;font-size:20px;font-weight:700}.sb-canvas-area{position:relative;border:2px solid #e5e7eb;border-radius:12px;overflow:hidden}.sb-canvas{display:block;cursor:crosshair;width:100%;height:auto}.sb-canvas-preview{position:absolute;inset:0;pointer-events:none}.sb-canvas-preview svg{width:100%;height:100%}.sb-toolbar{display:flex;flex-wrap:wrap;gap:8px;margin:12px 0;align-items:center}.sb-color-row{display:flex;gap:4px}.sb-color-btn{width:24px;height:24px;border-radius:50%;border:2px solid transparent;cursor:pointer;padding:0;transition:border-color .15s}.sb-color-btn.sb-active{border-color:var(--sb-accent, #6366f1)}.sb-size-row{display:flex;gap:4px;margin-left:auto}.sb-size-btn,.sb-action-btn{padding:4px 10px;font-size:12px;border:1px solid #d1d5db;background:#fff;border-radius:6px;cursor:pointer}.sb-size-btn.sb-active{background:var(--sb-accent, #6366f1);color:#fff;border-color:var(--sb-accent, #6366f1)}.sb-action-row{display:flex;gap:4px}.sb-action-btn:hover{background:#f3f4f6}.sb-form{display:flex;flex-direction:column;gap:12px}.sb-field{display:flex;flex-direction:column}.sb-label{font-size:13px;font-weight:500;margin-bottom:4px;display:flex;flex-direction:column;gap:4px}.sb-input{padding:8px 12px;font-size:14px;border:1px solid #d1d5db;border-radius:8px;outline:none;font-family:inherit}.sb-input:focus{border-color:var(--sb-accent, #6366f1);box-shadow:0 0 0 2px #6366f133}.sb-error{color:#dc2626;font-size:13px;margin:0}.sb-submit{padding:12px;font-size:15px;font-weight:600;color:#fff;background:var(--sb-accent, #6366f1);border:none;border-radius:10px;cursor:pointer;transition:opacity .15s}.sb-submit:disabled{opacity:.5;cursor:not-allowed}.sb-submit:not(:disabled):hover{opacity:.9}.sb-success{text-align:center;padding:48px 16px}.sb-success-text{font-size:20px;font-weight:600;color:#16a34a;margin:0}.sb-branding{text-align:center;padding:12px 0 4px;font-size:11px;color:#a3a3a3}.sb-branding a{color:inherit;text-decoration:none}.sb-branding a:hover{color:#737373;text-decoration:underline}.sb-remove-btn{position:absolute;top:6px;right:6px;background:#0000000d;border:none;border-radius:4px;padding:2px 6px;font-size:10px;color:#a3a3a3;cursor:pointer;opacity:0;transition:opacity .15s}.sb-card:hover .sb-remove-btn{opacity:1}.sb-remove-btn:hover{background:#ef44441a;color:#ef4444}",Ct=100,Qe=3e4;class he{constructor(t,s){h(this,p);h(this,Lt);h(this,J);h(this,g);h(this,H);h(this,Z,null);h(this,A,[]);h(this,$,null);h(this,q,!0);h(this,ot,!1);h(this,dt,null);h(this,ut,null);h(this,k,null);h(this,rt,null);d(this,Lt,t),d(this,H,s),d(this,J,t.attachShadow({mode:"open"}));const i=document.createElement("style");i.textContent=Ze,n(this,J).appendChild(i),d(this,g,document.createElement("div")),n(this,g).className="sb-root",n(this,g).setAttribute("role","region"),n(this,g).setAttribute("aria-label","Guestbook"),n(this,J).appendChild(n(this,g)),m(this,p,ve).call(this),m(this,p,ge).call(this)}destroy(){n(this,dt)&&clearInterval(n(this,dt)),n(this,ut)?.disconnect(),n(this,rt)?.disconnect(),n(this,J).innerHTML=""}}Lt=new WeakMap,J=new WeakMap,g=new WeakMap,H=new WeakMap,Z=new WeakMap,A=new WeakMap,$=new WeakMap,q=new WeakMap,ot=new WeakMap,dt=new WeakMap,ut=new WeakMap,k=new WeakMap,rt=new WeakMap,p=new WeakSet,ge=async function(){const[t,s]=await Promise.all([Ne(n(this,H)),Et(n(this,H))]);if(!t.ok){m(this,p,xe).call(this);return}d(this,Z,t.data),s.ok&&s.data&&(d(this,A,s.data.entries),d(this,$,s.data.cursor),d(this,q,n(this,$)!==null)),m(this,p,ye).call(this),m(this,p,Le).call(this)},ve=function(){n(this,g).innerHTML=`
      <div class="sb-skeleton">
        <div class="sb-skeleton-card"></div>
        <div class="sb-skeleton-card"></div>
        <div class="sb-skeleton-card"></div>
      </div>
    `,n(this,g).style.minHeight="200px"},xe=function(){n(this,g).innerHTML="",n(this,g).style.minHeight="0"},ye=function(){if(!n(this,Z))return;const t=n(this,Z).settings;n(this,g).innerHTML="",n(this,g).style.setProperty("--sb-bg",t.background_color),n(this,g).style.setProperty("--sb-card-bg",t.card_background_color),n(this,g).style.setProperty("--sb-text",t.text_color),n(this,g).style.setProperty("--sb-accent",t.accent_color),n(this,g).style.setProperty("--sb-card-radius",`${t.card_border_radius}px`),n(this,g).style.setProperty("--sb-font",t.font==="handwriting"?'"Caveat", cursive':t.font==="mono"?"monospace":"system-ui, sans-serif"),n(this,g).style.backgroundColor=t.background_color,d(this,k,document.createElement("div")),n(this,k).className="sb-wall",n(this,k).setAttribute("role","list"),n(this,k).setAttribute("aria-label","Guestbook entries"),n(this,g).appendChild(n(this,k)),n(this,A).length===0?m(this,p,we).call(this):m(this,p,wt).call(this);const s=document.createElement("button");if(s.className="sb-cta",s.textContent=t.cta_text,s.setAttribute("aria-label",t.cta_text),s.addEventListener("click",()=>m(this,p,Me).call(this)),n(this,g).appendChild(s),n(this,Z).branding){const i=document.createElement("a");i.className="sb-branding",i.href="https://signboard.app",i.target="_blank",i.rel="noopener noreferrer",i.textContent="Powered by SignBoard",n(this,g).appendChild(i)}},we=function(){n(this,k)&&(n(this,k).innerHTML=`
      <div class="sb-empty">
        <p class="sb-empty-text">Be the first to sign!</p>
      </div>
    `)},wt=function(){if(!n(this,k))return;n(this,k).innerHTML="";const t=Math.min(n(this,A).length,Ct),s=[];for(let i=0;i<t;i++){const r=n(this,A)[i],o=m(this,p,ke).call(this,r);n(this,k).appendChild(o),s.push(o)}if(n(this,A).length>Ct){const i=document.createElement("div");i.className="sb-overflow",i.textContent=`+ ${n(this,A).length-Ct} more entries`,n(this,k).appendChild(i)}requestAnimationFrame(()=>{n(this,k)&&(ue(n(this,k),s),n(this,ut)?.disconnect(),d(this,ut,Je(n(this,k),()=>Array.from(n(this,k).querySelectorAll(".sb-card")))))}),n(this,q)&&t<Ct&&m(this,p,Ee).call(this)},ke=function(t){const s=document.createElement("div");s.className="sb-card",s.setAttribute("role","listitem");const i=t.stroke_data,r=Ve(i),o=document.createElement("img");o.src=r,o.width=i.width,o.height=i.height,o.alt=`Drawing by ${t.name}`,o.className="sb-card-img",o.loading="lazy",s.appendChild(o);const a=document.createElement("p");if(a.className="sb-card-name",a.textContent=t.name,s.appendChild(a),t.message){const l=document.createElement("p");l.className="sb-card-message",l.textContent=t.message,s.appendChild(l)}if(t.link){const l=document.createElement("a");l.href=t.link,l.target="_blank",l.rel="noopener noreferrer",l.className="sb-card-link",l.setAttribute("aria-label",`Visit ${t.name}'s link`);const c=document.createElement("span");c.className="sb-link-icon",c.textContent="↗",l.appendChild(c),s.appendChild(l)}try{const l=localStorage.getItem(`sb_del_${t.id}`);if(l){const c=document.createElement("button");c.className="sb-remove-btn",c.textContent="Remove",c.setAttribute("aria-label","Remove your entry"),c.addEventListener("click",async u=>{u.stopPropagation(),c.disabled=!0,c.textContent="Removing...",(await _e(n(this,H),t.id,l)).ok?(localStorage.removeItem(`sb_del_${t.id}`),m(this,p,Yt).call(this)):(c.disabled=!1,c.textContent="Remove")}),s.appendChild(c)}}catch{}return s},Ee=function(){const t=document.createElement("div");t.className="sb-sentinel",n(this,k)?.appendChild(t),n(this,rt)?.disconnect(),d(this,rt,new IntersectionObserver(async s=>{s[0]?.isIntersecting&&n(this,q)&&!n(this,ot)&&await m(this,p,Ce).call(this)},{rootMargin:"200px"})),n(this,rt).observe(t)},Ce=async function(){if(n(this,ot)||!n(this,q)||!n(this,$))return;d(this,ot,!0);const t=await Et(n(this,H),n(this,$));t.ok&&t.data&&(n(this,A).push(...t.data.entries),d(this,$,t.data.cursor),d(this,q,n(this,$)!==null),m(this,p,wt).call(this)),d(this,ot,!1)},Le=function(){d(this,dt,setInterval(async()=>{if(document.hidden)return;const t=await Et(n(this,H));if(t.ok&&t.data&&t.data.entries.length>0){const s=n(this,A)[0]?.id,i=t.data.entries[0]?.id;s!==i&&(d(this,A,t.data.entries),d(this,$,t.data.cursor),d(this,q,n(this,$)!==null),m(this,p,wt).call(this))}},Qe))},Me=async function(){const{openModal:t}=await Promise.resolve().then(()=>ln);t(n(this,J),n(this,H),n(this,Z),()=>{m(this,p,Yt).call(this)})},Yt=async function(){const t=await Et(n(this,H));t.ok&&t.data&&(d(this,A,t.data.entries),d(this,$,t.data.cursor),d(this,q,n(this,$)!==null),m(this,p,wt).call(this))};function pe(){const e=document.querySelectorAll('script[src*="widget.js"]'),t=e[e.length-1];if(t?.src){const i=new URL(t.src);C(i.origin)}document.querySelectorAll("[data-sb-id]").forEach(i=>{const r=i.getAttribute("data-sb-id");r&&!i.shadowRoot&&new he(i,r)})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",pe):pe(),new MutationObserver(e=>{for(const t of e)for(const s of t.addedNodes)if(s instanceof HTMLElement&&s.hasAttribute("data-sb-id")&&!s.shadowRoot){const i=s.getAttribute("data-sb-id");i&&new he(s,i)}}).observe(document.body,{childList:!0,subtree:!0});const tn=100,en=5e3,Dt=["#1a1a1a","#6b7280","#2563eb","#dc2626","#16a34a","#9333ea","#ea580c","#ec4899"],Ot=[{label:"Thin",value:4},{label:"Medium",value:8},{label:"Thick",value:14}];class nn{constructor(t,s,i,r){h(this,L);h(this,b);h(this,ht);h(this,j);h(this,_,[]);h(this,T,null);h(this,Q,null);h(this,bt,Dt[0]);h(this,ft,Ot[1].value);h(this,tt);h(this,et);h(this,nt);h(this,at);h(this,mt,t=>{if(t.preventDefault(),n(this,Q)!==null||n(this,_).length>=tn)return;d(this,Q,t.pointerId),n(this,b).setPointerCapture(t.pointerId);const[s,i]=m(this,L,Gt).call(this,t);d(this,T,{points:[[s,i,t.pressure||.5]],color:n(this,bt),size:n(this,ft)})});h(this,gt,t=>{if(t.preventDefault(),t.pointerId!==n(this,Q)||!n(this,T)||n(this,_).reduce((o,a)=>o+a.points.length,0)+n(this,T).points.length>=en)return;const[i,r]=m(this,L,Gt).call(this,t);n(this,T).points.push([i,r,t.pressure||.5]),m(this,L,_t).call(this)});h(this,K,t=>{t.pointerId===n(this,Q)&&(d(this,Q,null),n(this,T)&&n(this,T).points.length>1&&(n(this,_).push(n(this,T)),n(this,at).call(this)),d(this,T,null),m(this,L,_t).call(this))});d(this,tt,s),d(this,et,i),d(this,at,r),d(this,nt,Math.min(window.devicePixelRatio||1,2)),d(this,b,document.createElement("canvas")),n(this,b).width=s*n(this,nt),n(this,b).height=i*n(this,nt),n(this,b).style.width=`${s}px`,n(this,b).style.height=`${i}px`,n(this,b).style.touchAction="none",n(this,b).className="sb-canvas",d(this,ht,n(this,b).getContext("2d")),n(this,ht).scale(n(this,nt),n(this,nt)),d(this,j,document.createElement("div")),n(this,j).className="sb-canvas-preview",n(this,j).style.display="none",t.appendChild(n(this,b)),t.appendChild(n(this,j)),m(this,L,Se).call(this),m(this,L,kt).call(this)}setColor(t){d(this,bt,t)}setSize(t){d(this,ft,t)}undo(){n(this,_).length!==0&&(n(this,_).pop(),n(this,at).call(this),n(this,_).length===0?(n(this,j).style.display="none",n(this,b).style.opacity="1",m(this,L,kt).call(this)):m(this,L,_t).call(this))}clear(){d(this,_,[]),n(this,j).style.display="none",n(this,b).style.opacity="1",m(this,L,kt).call(this),n(this,at).call(this)}isEmpty(){return n(this,_).length===0}getDrawingData(){return{version:1,width:n(this,tt),height:n(this,et),strokes:n(this,_).map(t=>({points:t.points.map(([s,i,r])=>[s,i,r]),color:t.color,size:t.size}))}}destroy(){n(this,b).removeEventListener("pointerdown",n(this,mt)),n(this,b).removeEventListener("pointermove",n(this,gt)),n(this,b).removeEventListener("pointerup",n(this,K)),n(this,b).removeEventListener("pointercancel",n(this,K)),n(this,b).removeEventListener("pointerleave",n(this,K))}}b=new WeakMap,ht=new WeakMap,j=new WeakMap,_=new WeakMap,T=new WeakMap,Q=new WeakMap,bt=new WeakMap,ft=new WeakMap,tt=new WeakMap,et=new WeakMap,nt=new WeakMap,at=new WeakMap,L=new WeakSet,Se=function(){n(this,b).addEventListener("pointerdown",n(this,mt),{passive:!1}),n(this,b).addEventListener("pointermove",n(this,gt),{passive:!1}),n(this,b).addEventListener("pointerup",n(this,K)),n(this,b).addEventListener("pointercancel",n(this,K)),n(this,b).addEventListener("pointerleave",n(this,K))},mt=new WeakMap,gt=new WeakMap,K=new WeakMap,Gt=function(t){const s=n(this,b).getBoundingClientRect(),i=Math.round((t.clientX-s.left)/s.width*n(this,tt)),r=Math.round((t.clientY-s.top)/s.height*n(this,et));return[i,r]},kt=function(){n(this,ht).clearRect(0,0,n(this,tt),n(this,et))},_t=function(){m(this,L,kt).call(this);const t=n(this,T)?[...n(this,_),n(this,T)]:n(this,_);if(t.length===0)return;const s={width:n(this,tt),height:n(this,et),strokes:t},i=de(s);n(this,j).innerHTML=i,n(this,j).style.display="block",n(this,b).style.opacity="0"};function sn(e,t){const s=document.createElement("div");s.className="sb-toolbar";const i=document.createElement("div");i.className="sb-color-row",Dt.forEach(c=>{const u=document.createElement("button");u.className="sb-color-btn",u.style.backgroundColor=c,u.setAttribute("aria-label",`Pen color ${c}`),u.addEventListener("click",()=>{t.setColor(c),i.querySelectorAll(".sb-color-btn").forEach(f=>f.classList.remove("sb-active")),u.classList.add("sb-active")}),c===Dt[0]&&u.classList.add("sb-active"),i.appendChild(u)}),s.appendChild(i);const r=document.createElement("div");r.className="sb-size-row",Ot.forEach(c=>{const u=document.createElement("button");u.className="sb-size-btn",u.textContent=c.label,u.setAttribute("aria-label",`Pen size ${c.label}`),u.addEventListener("click",()=>{t.setSize(c.value),r.querySelectorAll(".sb-size-btn").forEach(f=>f.classList.remove("sb-active")),u.classList.add("sb-active")}),c.value===Ot[1].value&&u.classList.add("sb-active"),r.appendChild(u)}),s.appendChild(r);const o=document.createElement("div");o.className="sb-action-row";const a=document.createElement("button");a.className="sb-action-btn",a.textContent="Undo",a.setAttribute("aria-label","Undo last stroke"),a.addEventListener("click",()=>t.undo()),o.appendChild(a);const l=document.createElement("button");l.className="sb-action-btn",l.textContent="Clear",l.setAttribute("aria-label","Clear drawing"),l.addEventListener("click",()=>t.clear()),o.appendChild(l),s.appendChild(o),e.appendChild(s)}const on=400,rn=250;function an(e,t,s,i){const r=s.settings,o=document.createElement("div");o.className="sb-modal-backdrop",o.setAttribute("role","dialog"),o.setAttribute("aria-modal","true"),o.setAttribute("aria-label","Sign the guestbook");const a=document.createElement("div");a.className="sb-modal";const l=document.createElement("button");l.className="sb-modal-close",l.textContent="×",l.setAttribute("aria-label","Close"),a.appendChild(l);const c=document.createElement("h2");c.className="sb-modal-title",c.textContent=r.cta_text,a.appendChild(c);const u=document.createElement("div");u.className="sb-canvas-area",u.style.backgroundColor=r.canvas_background_color,a.appendChild(u);const f=new nn(u,on,rn,()=>{W()});sn(a,f);const P=document.createElement("div");P.className="sb-form";const v=Ht("Your name *","name",!0,100);P.appendChild(v.wrapper);let M=null;r.show_message_field&&(M=Ht("Message (optional)","message",!1,200),P.appendChild(M.wrapper));let z=null;r.show_link_field&&(z=Ht("Link (optional)","link",!1,500,"url"),z.input.placeholder="https://...",P.appendChild(z.wrapper));const I=document.createElement("input");I.type="text",I.name="_hp",I.tabIndex=-1,I.autocomplete="off",I.style.cssText="position:absolute;left:-9999px;width:1px;height:1px;overflow:hidden",P.appendChild(I);const D=document.createElement("p");D.className="sb-error",D.style.display="none",P.appendChild(D);const R=document.createElement("button");R.className="sb-submit",R.textContent="Submit",R.disabled=!0,P.appendChild(R),a.appendChild(P),o.appendChild(a),e.appendChild(o),document.body.style.overflow="hidden",requestAnimationFrame(()=>v.input.focus());let U=!1;function W(){R.disabled=f.isEmpty()||!v.input.value.trim()||U}v.input.addEventListener("input",W);function Mt(x){(x.ctrlKey||x.metaKey)&&x.key==="z"&&(x.preventDefault(),f.undo()),x.key==="Escape"&&S()}o.addEventListener("keydown",Mt);function S(){f.destroy(),document.body.style.overflow="",o.remove()}l.addEventListener("click",S),o.addEventListener("click",x=>{x.target===o&&S()}),R.addEventListener("click",async()=>{if(U||f.isEmpty()||!v.input.value.trim())return;U=!0,R.disabled=!0,R.textContent="Submitting...",D.style.display="none";const x=await ze(t,{name:v.input.value.trim(),message:M?.input.value.trim()||void 0,link:z?.input.value.trim()||void 0,stroke_data:f.getDrawingData(),_hp:I.value||void 0});if(x.ok){try{const O=`sb_del_${x.data.id}`;localStorage.setItem(O,x.data.deletion_token)}catch{}a.innerHTML=`
        <div class="sb-success">
          <p class="sb-success-text">Thanks for signing!</p>
        </div>
      `,setTimeout(()=>{S(),i()},1500)}else U=!1,R.disabled=!1,R.textContent="Submit",D.textContent=x.error.error||"Something went wrong",D.style.display="block"});const vt='button, input, [tabindex]:not([tabindex="-1"])';o.addEventListener("keydown",x=>{if(x.key!=="Tab")return;const O=Array.from(a.querySelectorAll(vt));if(O.length===0)return;const lt=O[0],F=O[O.length-1];x.shiftKey&&document.activeElement===lt?(x.preventDefault(),F.focus()):!x.shiftKey&&document.activeElement===F&&(x.preventDefault(),lt.focus())})}function Ht(e,t,s,i,r="text"){const o=document.createElement("div");o.className="sb-field";const a=document.createElement("label");a.className="sb-label",a.textContent=e;const l=document.createElement("input");return l.type=r,l.name=t,l.required=s,l.maxLength=i,l.className="sb-input",l.autocomplete="off",a.appendChild(l),o.appendChild(a),{wrapper:o,input:l}}const ln=Object.freeze(Object.defineProperty({__proto__:null,openModal:an},Symbol.toStringTag,{value:"Module"}))})();
