var ye=k=>{throw TypeError(k)};var Yt=(k,L,E)=>L.has(k)||ye("Cannot "+E);var n=(k,L,E)=>(Yt(k,L,"read from private field"),E?E.call(k):L.get(k)),h=(k,L,E)=>L.has(k)?ye("Cannot add the same private member more than once"):L instanceof WeakSet?L.add(k):L.set(k,E),d=(k,L,E,Y)=>(Yt(k,L,"write to private field"),Y?Y.call(k,E):L.set(k,E),E),m=(k,L,E)=>(Yt(k,L,"access private method"),E);(function(){"use strict";var Mt,Z,g,H,Q,_,$,q,ot,dt,ut,w,rt,p,ke,we,Ee,Ce,Le,kt,Me,Se,Ae,Ne,ze,Gt,b,ht,j,z,T,tt,bt,ft,et,nt,st,at,M,_e,mt,gt,F,Vt,wt,_t;let k="";function L(e){k=e.replace(/\/$/,"")}const E=new Map,Y=new Map;function Xt(e){const t=`/api/v1/guestbooks/${e}/entries`;for(const s of Array.from(E.keys()))s.startsWith(t)&&E.delete(s);for(const s of Array.from(Y.keys()))s.startsWith(t)&&Y.delete(s)}async function Et(e,t){const s=`${k}${e}`,i={"Content-Type":"application/json"};if(t?.useEtag){const r=E.get(e);r&&(i["If-None-Match"]=r)}try{const r=await fetch(s,{...t,headers:{...i,...t?.headers}});if(r.status===304)return Y.has(e)?{ok:!0,data:Y.get(e)}:{ok:!0,data:null};if(!r.ok)return{ok:!1,error:await r.json().catch(()=>({error:r.statusText}))};if(t?.useEtag){const a=r.headers.get("ETag");a&&E.set(e,a)}const o=await r.json();return t?.useEtag&&Y.set(e,o),{ok:!0,data:o}}catch{return{ok:!1,error:{error:"Network error"}}}}function $e(e){return Et(`/api/v1/guestbooks/${e}`)}function Ct(e,t){const s=t?`?cursor=${encodeURIComponent(t)}`:"";return Et(`/api/v1/guestbooks/${e}/entries${s}`,{useEtag:!t})}function Te(e,t){return Et(`/api/v1/guestbooks/${e}/entries`,{method:"POST",body:JSON.stringify(t)}).then(s=>(s.ok&&Xt(e),s))}function Pe(e,t,s){return Et(`/api/v1/guestbooks/${e}/entries/${t}`,{method:"DELETE",body:JSON.stringify({deletion_token:s})}).then(i=>(i.ok&&Xt(e),i))}const{PI:Ie}=Math,pt=Ie+1e-4,Jt=.5,Zt=[1,1];function Qt(e,t,s,i=r=>r){return e*i(.5-t*(.5-s))}const{min:$t}=Math;function te(e,t,s){let i=$t(1,t/s);return $t(1,e+($t(1,1-i)-e)*(i*.275))}function Re(e){return[-e[0],-e[1]]}function B(e,t){return[e[0]+t[0],e[1]+t[1]]}function ee(e,t,s){return e[0]=t[0]+s[0],e[1]=t[1]+s[1],e}function G(e,t){return[e[0]-t[0],e[1]-t[1]]}function Tt(e,t,s){return e[0]=t[0]-s[0],e[1]=t[1]-s[1],e}function V(e,t){return[e[0]*t,e[1]*t]}function Pt(e,t,s){return e[0]=t[0]*s,e[1]=t[1]*s,e}function De(e,t){return[e[0]/t,e[1]/t]}function ne(e){return[e[1],-e[0]]}function It(e,t){let s=t[0];return e[0]=t[1],e[1]=-s,e}function se(e,t){return e[0]*t[0]+e[1]*t[1]}function Oe(e,t){return e[0]===t[0]&&e[1]===t[1]}function He(e){return Math.hypot(e[0],e[1])}function ie(e,t){let s=e[0]-t[0],i=e[1]-t[1];return s*s+i*i}function oe(e){return De(e,He(e))}function je(e,t){return Math.hypot(e[1]-t[1],e[0]-t[0])}function Rt(e,t,s){let i=Math.sin(s),r=Math.cos(s),o=e[0]-t[0],a=e[1]-t[1],l=o*r-a*i,c=o*i+a*r;return[l+t[0],c+t[1]]}function re(e,t,s,i){let r=Math.sin(i),o=Math.cos(i),a=t[0]-s[0],l=t[1]-s[1],c=a*o-l*r,u=a*r+l*o;return e[0]=c+s[0],e[1]=u+s[1],e}function ae(e,t,s){return B(e,V(G(t,e),s))}function Be(e,t,s,i){let r=s[0]-t[0],o=s[1]-t[1];return e[0]=t[0]+r*i,e[1]=t[1]+o*i,e}function le(e,t,s){return B(e,V(t,s))}const C=[0,0],X=[0,0],J=[0,0];function qe(e,t){let s=le(e,oe(ne(G(e,B(e,[1,1])))),-t),i=[],r=1/13;for(let o=r;o<=1;o+=r)i.push(Rt(s,e,pt*2*o));return i}function Ue(e,t,s){let i=[],r=1/s;for(let o=r;o<=1;o+=r)i.push(Rt(t,e,pt*o));return i}function We(e,t,s){let i=G(t,s),r=V(i,.5),o=V(i,.51);return[G(e,r),G(e,o),B(e,o),B(e,r)]}function Fe(e,t,s,i){let r=[],o=le(e,t,s),a=1/i;for(let l=a;l<1;l+=a)r.push(Rt(o,e,pt*3*l));return r}function Ke(e,t,s){return[B(e,V(t,s)),B(e,V(t,s*.99)),G(e,V(t,s*.99)),G(e,V(t,s))]}function ce(e,t,s){return e===!1||e===void 0?0:e===!0?Math.max(t,s):e}function Ye(e,t,s){return e.slice(0,10).reduce((i,r)=>{let o=r.pressure;return t&&(o=te(i,r.distance,s)),(i+o)/2},e[0].pressure)}function Ge(e,t={}){let{size:s=16,smoothing:i=.5,thinning:r=.5,simulatePressure:o=!0,easing:a=y=>y,start:l={},end:c={},last:u=!1}=t,{cap:f=!0,easing:P=y=>y*(2-y)}=l,{cap:v=!0,easing:S=y=>--y*y*y+1}=c;if(e.length===0||s<=0)return[];let N=e[e.length-1].runningLength,I=ce(l.taper,s,N),D=ce(c.taper,s,N),R=(s*i)**2,U=[],K=[],St=Ye(e,o,s),A=Qt(s,r,e[e.length-1].pressure,a),vt,x=e[0].vector,O=e[0].point,lt=O,W=O,ct=lt,Bt=!1;for(let y=0;y<e.length;y++){let{pressure:Ft}=e[y],{point:it,vector:xt,distance:bn,runningLength:yt}=e[y],Nt=y===e.length-1;if(!Nt&&N-yt<3)continue;r?(o&&(Ft=te(St,bn,s)),A=Qt(s,r,Ft,a)):A=s/2,vt===void 0&&(vt=A);let fn=yt<I?P(yt/I):1,mn=N-yt<D?S((N-yt)/D):1;A=Math.max(.01,A*Math.min(fn,mn));let ve=(Nt?e[y]:e[y+1]).vector,Kt=Nt?1:se(xt,ve),gn=se(xt,x)<0&&!Bt,xe=Kt!==null&&Kt<0;if(gn||xe){It(C,x),Pt(C,C,A);for(let zt=0;zt<=1;zt+=.07692307692307693)Tt(X,it,C),re(X,X,it,pt*zt),W=[X[0],X[1]],U.push(W),ee(J,it,C),re(J,J,it,pt*-zt),ct=[J[0],J[1]],K.push(ct);O=W,lt=ct,xe&&(Bt=!0);continue}if(Bt=!1,Nt){It(C,xt),Pt(C,C,A),U.push(G(it,C)),K.push(B(it,C));continue}Be(C,ve,xt,Kt),It(C,C),Pt(C,C,A),Tt(X,it,C),W=[X[0],X[1]],(y<=1||ie(O,W)>R)&&(U.push(W),O=W),ee(J,it,C),ct=[J[0],J[1]],(y<=1||ie(lt,ct)>R)&&(K.push(ct),lt=ct),St=Ft,x=xt}let qt=[e[0].point[0],e[0].point[1]],Ut=e.length>1?[e[e.length-1].point[0],e[e.length-1].point[1]]:B(e[0].point,[1,1]),Wt=[],At=[];if(e.length===1){if(!(I||D)||u)return qe(qt,vt||A)}else{I||D&&e.length===1||(f?Wt.push(...Ue(qt,K[0],13)):Wt.push(...We(qt,U[0],K[0])));let y=ne(Re(e[e.length-1].vector));D||I&&e.length===1?At.push(Ut):v?At.push(...Fe(Ut,y,A,29)):At.push(...Ke(Ut,y,A))}return U.concat(At,K.reverse(),Wt)}const de=[0,0];function ue(e){return e!=null&&e>=0}function Ve(e,t={}){let{streamline:s=.5,size:i=16,last:r=!1}=t;if(e.length===0)return[];let o=.15+(1-s)*.85,a=Array.isArray(e[0])?e:e.map(({x:v,y:S,pressure:N=Jt})=>[v,S,N]);if(a.length===2){let v=a[1];a=a.slice(0,-1);for(let S=1;S<5;S++)a.push(ae(a[0],v,S/4))}a.length===1&&(a=[...a,[...B(a[0],Zt),...a[0].slice(2)]]);let l=[{point:[a[0][0],a[0][1]],pressure:ue(a[0][2])?a[0][2]:.25,vector:[...Zt],distance:0,runningLength:0}],c=!1,u=0,f=l[0],P=a.length-1;for(let v=1;v<a.length;v++){let S=r&&v===P?[a[v][0],a[v][1]]:ae(f.point,a[v],o);if(Oe(f.point,S))continue;let N=je(S,f.point);if(u+=N,v<P&&!c){if(u<i)continue;c=!0}Tt(de,f.point,S),f={point:S,pressure:ue(a[v][2])?a[v][2]:Jt,vector:oe(de),distance:N,runningLength:u},l.push(f)}return l[0].vector=l[1]?.vector||[0,0],l}function Xe(e,t={}){return Ge(Ve(e,t),t)}var Je=Xe;function Ze(e){if(e.length<2)return"";const t=[];t.push(`M ${Math.round(e[0][0])} ${Math.round(e[0][1])}`);for(let i=1;i<e.length-1;i++){const r=Math.round((e[i][0]+e[i+1][0])/2),o=Math.round((e[i][1]+e[i+1][1])/2);t.push(`Q ${Math.round(e[i][0])} ${Math.round(e[i][1])} ${r} ${o}`)}const s=e[e.length-1];return t.push(`L ${Math.round(s[0])} ${Math.round(s[1])}`),t.push("Z"),t.join(" ")}function he(e){const{width:t,height:s,strokes:i}=e,r=i.map(o=>{const a=Je(o.points.map(([c,u,f])=>[c,u,f]),{size:o.size,thinning:.5,smoothing:.5,streamline:.5,simulatePressure:!0});return`<path d="${Ze(a)}" fill="${o.color}" />`});return[`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 ${t} ${s}" width="${t}" height="${s}">`,...r,"</svg>"].join("")}function Qe(e){const t=he(e);return`data:image/svg+xml;charset=utf-8,${encodeURIComponent(t)}`}const Dt=12;function tn(e){return e<480?1:e<768?2:e<1024?3:4}function pe(e,t){const s=e.offsetWidth;if(!s||t.length===0)return;const i=tn(s),r=(s-Dt*(i-1))/i,o=new Array(i).fill(0);for(const a of t){a.style.position="absolute",a.style.width=`${r}px`;let l=0;for(let f=1;f<i;f++)o[f]<o[l]&&(l=f);const c=l*(r+Dt),u=o[l];a.style.transform=`translate(${Math.round(c)}px, ${Math.round(u)}px)`,o[l]+=a.offsetHeight+Dt}e.style.height=`${Math.max(...o)}px`}function en(e,t){let s=null;const i=new ResizeObserver(()=>{s&&clearTimeout(s),s=setTimeout(()=>{pe(e,t())},150)});return i.observe(e),i}const nn=".sb-root{font-family:var(--sb-font, system-ui, sans-serif);color:var(--sb-text, #1a1a1a);box-sizing:border-box;position:relative}.sb-root *,.sb-root *:before,.sb-root *:after{box-sizing:border-box}.sb-skeleton{display:flex;gap:12px;padding:16px 0}.sb-skeleton-card{flex:1;height:120px;border-radius:var(--sb-card-radius, 12px);background:linear-gradient(90deg,#f0f0f0 25%,#e0e0e0,#f0f0f0 75%);background-size:200% 100%;animation:sb-shimmer 1.5s ease-in-out infinite}@keyframes sb-shimmer{0%{background-position:200% 0}to{background-position:-200% 0}}.sb-wall{position:relative;width:100%;padding:8px 0}.sb-empty{text-align:center;padding:48px 16px}.sb-empty-text{font-size:18px;color:var(--sb-text, #1a1a1a);opacity:.6;margin:0}.sb-card{position:relative;background:var(--sb-card-bg, #ffffff);border-radius:var(--sb-card-radius, 12px);padding:12px;box-shadow:0 1px 3px #00000014;transition:opacity .3s ease;animation:sb-fadeIn .4s ease}@keyframes sb-fadeIn{0%{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}.sb-card-img{width:100%;height:auto;display:block;border-radius:6px}.sb-card-name{margin:8px 0 0;font-size:14px;font-weight:600}.sb-card-message{margin:4px 0 0;font-size:12px;opacity:.7}.sb-card-link{display:inline-block;margin-top:4px;font-size:12px;color:var(--sb-accent, #6366f1);text-decoration:none}.sb-link-icon{font-size:14px}.sb-overflow{text-align:center;padding:16px;font-size:13px;opacity:.6}.sb-sentinel{height:1px;width:100%}.sb-cta{display:block;margin:16px auto;padding:12px 28px;font-size:16px;font-weight:600;font-family:var(--sb-font, system-ui, sans-serif);color:#fff;background:var(--sb-accent, #6366f1);border:none;border-radius:9999px;cursor:pointer;transition:transform .15s ease,box-shadow .15s ease}.sb-cta:hover{transform:translateY(-1px);box-shadow:0 4px 12px #00000026}.sb-cta:active{transform:translateY(0)}.sb-modal-backdrop{position:fixed;inset:0;z-index:999999;background:#00000080;display:flex;align-items:center;justify-content:center;padding:16px}.sb-modal{background:#fff;border-radius:16px;width:100%;max-width:460px;max-height:90vh;overflow-y:auto;padding:24px;position:relative;box-shadow:0 20px 60px #0000004d}.sb-modal-close{position:absolute;top:12px;right:12px;width:32px;height:32px;border:none;background:none;font-size:24px;cursor:pointer;color:#6b7280;border-radius:6px;display:flex;align-items:center;justify-content:center}.sb-modal-close:hover{background:#f3f4f6}.sb-modal-title{margin:0 0 16px;font-size:20px;font-weight:700}.sb-canvas-area{position:relative;border:2px solid #e5e7eb;border-radius:12px;overflow:hidden}.sb-canvas{display:block;cursor:crosshair;width:100%;height:auto}.sb-canvas-preview{position:absolute;inset:0;pointer-events:none}.sb-canvas-preview svg{width:100%;height:100%}.sb-toolbar{display:flex;flex-wrap:wrap;gap:8px;margin:12px 0;align-items:center}.sb-color-row{display:flex;gap:4px}.sb-color-btn{width:24px;height:24px;border-radius:50%;border:2px solid transparent;cursor:pointer;padding:0;transition:border-color .15s}.sb-color-btn.sb-active{border-color:var(--sb-accent, #6366f1)}.sb-size-row{display:flex;gap:4px;margin-left:auto}.sb-size-btn,.sb-action-btn{padding:4px 10px;font-size:12px;border:1px solid #d1d5db;background:#fff;border-radius:6px;cursor:pointer}.sb-size-btn.sb-active{background:var(--sb-accent, #6366f1);color:#fff;border-color:var(--sb-accent, #6366f1)}.sb-action-row{display:flex;gap:4px}.sb-action-btn:hover{background:#f3f4f6}.sb-form{display:flex;flex-direction:column;gap:12px}.sb-field{display:flex;flex-direction:column}.sb-label{font-size:13px;font-weight:500;margin-bottom:4px;display:flex;flex-direction:column;gap:4px}.sb-input{padding:8px 12px;font-size:14px;border:1px solid #d1d5db;border-radius:8px;outline:none;font-family:inherit}.sb-input:focus{border-color:var(--sb-accent, #6366f1);box-shadow:0 0 0 2px #6366f133}.sb-error{color:#dc2626;font-size:13px;margin:0}.sb-submit{padding:12px;font-size:15px;font-weight:600;color:#fff;background:var(--sb-accent, #6366f1);border:none;border-radius:10px;cursor:pointer;transition:opacity .15s}.sb-submit:disabled{opacity:.5;cursor:not-allowed}.sb-submit:not(:disabled):hover{opacity:.9}.sb-success{text-align:center;padding:48px 16px}.sb-success-text{font-size:20px;font-weight:600;color:#16a34a;margin:0}.sb-branding{text-align:center;padding:12px 0 4px;font-size:11px;color:#a3a3a3}.sb-branding a{color:inherit;text-decoration:none}.sb-branding a:hover{color:#737373;text-decoration:underline}.sb-remove-btn{position:absolute;top:6px;right:6px;background:#0000000d;border:none;border-radius:4px;padding:2px 6px;font-size:10px;color:#a3a3a3;cursor:pointer;opacity:0;transition:opacity .15s}.sb-card:hover .sb-remove-btn{opacity:1}.sb-remove-btn:hover{background:#ef44441a;color:#ef4444}",Lt=100,sn=3e4;class be{constructor(t,s){h(this,p);h(this,Mt);h(this,Z);h(this,g);h(this,H);h(this,Q,null);h(this,_,[]);h(this,$,null);h(this,q,!0);h(this,ot,!1);h(this,dt,null);h(this,ut,null);h(this,w,null);h(this,rt,null);d(this,Mt,t),d(this,H,s),d(this,Z,t.attachShadow({mode:"open"}));const i=document.createElement("style");i.textContent=nn,n(this,Z).appendChild(i),d(this,g,document.createElement("div")),n(this,g).className="sb-root",n(this,g).setAttribute("role","region"),n(this,g).setAttribute("aria-label","Guestbook"),n(this,Z).appendChild(n(this,g)),m(this,p,we).call(this),m(this,p,ke).call(this)}destroy(){n(this,dt)&&clearInterval(n(this,dt)),n(this,ut)?.disconnect(),n(this,rt)?.disconnect(),n(this,Z).innerHTML=""}}Mt=new WeakMap,Z=new WeakMap,g=new WeakMap,H=new WeakMap,Q=new WeakMap,_=new WeakMap,$=new WeakMap,q=new WeakMap,ot=new WeakMap,dt=new WeakMap,ut=new WeakMap,w=new WeakMap,rt=new WeakMap,p=new WeakSet,ke=async function(){const[t,s]=await Promise.all([$e(n(this,H)),Ct(n(this,H))]);if(!t.ok){m(this,p,Ee).call(this);return}d(this,Q,t.data),s.ok&&s.data&&(d(this,_,s.data.entries),d(this,$,s.data.cursor),d(this,q,n(this,$)!==null)),m(this,p,Ce).call(this),m(this,p,Ne).call(this)},we=function(){n(this,g).innerHTML=`
      <div class="sb-skeleton">
        <div class="sb-skeleton-card"></div>
        <div class="sb-skeleton-card"></div>
        <div class="sb-skeleton-card"></div>
      </div>
    `,n(this,g).style.minHeight="200px"},Ee=function(){n(this,g).innerHTML="",n(this,g).style.minHeight="0"},Ce=function(){if(!n(this,Q))return;const t=n(this,Q).settings;n(this,g).innerHTML="",n(this,g).style.setProperty("--sb-bg",t.background_color),n(this,g).style.setProperty("--sb-card-bg",t.card_background_color),n(this,g).style.setProperty("--sb-text",t.text_color),n(this,g).style.setProperty("--sb-accent",t.accent_color),n(this,g).style.setProperty("--sb-card-radius",`${t.card_border_radius}px`),n(this,g).style.setProperty("--sb-font",t.font==="handwriting"?'"Caveat", cursive':t.font==="mono"?"monospace":"system-ui, sans-serif"),n(this,g).style.backgroundColor=t.background_color,d(this,w,document.createElement("div")),n(this,w).className="sb-wall",n(this,w).setAttribute("role","list"),n(this,w).setAttribute("aria-label","Guestbook entries"),n(this,g).appendChild(n(this,w)),n(this,_).length===0?m(this,p,Le).call(this):m(this,p,kt).call(this);const s=document.createElement("button");if(s.className="sb-cta",s.textContent=t.cta_text,s.setAttribute("aria-label",t.cta_text),s.addEventListener("click",()=>m(this,p,ze).call(this)),n(this,g).appendChild(s),n(this,Q).branding){const i=document.createElement("a");i.className="sb-branding",i.href="https://signboard.app",i.target="_blank",i.rel="noopener noreferrer",i.textContent="Powered by SignBoard",n(this,g).appendChild(i)}},Le=function(){n(this,w)&&(n(this,w).innerHTML=`
      <div class="sb-empty">
        <p class="sb-empty-text">Be the first to sign!</p>
      </div>
    `)},kt=function(){if(!n(this,w))return;n(this,w).innerHTML="";const t=Math.min(n(this,_).length,Lt),s=[];for(let i=0;i<t;i++){const r=n(this,_)[i],o=m(this,p,Me).call(this,r);n(this,w).appendChild(o),s.push(o)}if(n(this,_).length>Lt){const i=document.createElement("div");i.className="sb-overflow",i.textContent=`+ ${n(this,_).length-Lt} more entries`,n(this,w).appendChild(i)}requestAnimationFrame(()=>{n(this,w)&&(pe(n(this,w),s),n(this,ut)?.disconnect(),d(this,ut,en(n(this,w),()=>Array.from(n(this,w).querySelectorAll(".sb-card")))))}),n(this,q)&&t<Lt&&m(this,p,Se).call(this)},Me=function(t){const s=document.createElement("div");s.className="sb-card",s.setAttribute("role","listitem");const i=t.stroke_data,r=Qe(i),o=document.createElement("img");o.src=r,o.width=i.width,o.height=i.height,o.alt=`Drawing by ${t.name}`,o.className="sb-card-img",o.loading="lazy",s.appendChild(o);const a=document.createElement("p");if(a.className="sb-card-name",a.textContent=t.name,s.appendChild(a),t.message){const l=document.createElement("p");l.className="sb-card-message",l.textContent=t.message,s.appendChild(l)}if(t.link){const l=document.createElement("a");l.href=t.link,l.target="_blank",l.rel="noopener noreferrer",l.className="sb-card-link",l.setAttribute("aria-label",`Visit ${t.name}'s link`);const c=document.createElement("span");c.className="sb-link-icon",c.textContent="↗",l.appendChild(c),s.appendChild(l)}try{const l=localStorage.getItem(`sb_del_${t.id}`);if(l){const c=document.createElement("button");c.className="sb-remove-btn",c.textContent="Remove",c.setAttribute("aria-label","Remove your entry"),c.addEventListener("click",async u=>{u.stopPropagation(),c.disabled=!0,c.textContent="Removing...",(await Pe(n(this,H),t.id,l)).ok?(localStorage.removeItem(`sb_del_${t.id}`),m(this,p,Gt).call(this)):(c.disabled=!1,c.textContent="Remove")}),s.appendChild(c)}}catch{}return s},Se=function(){const t=document.createElement("div");t.className="sb-sentinel",n(this,w)?.appendChild(t),n(this,rt)?.disconnect(),d(this,rt,new IntersectionObserver(async s=>{s[0]?.isIntersecting&&n(this,q)&&!n(this,ot)&&await m(this,p,Ae).call(this)},{rootMargin:"200px"})),n(this,rt).observe(t)},Ae=async function(){if(n(this,ot)||!n(this,q)||!n(this,$))return;d(this,ot,!0);const t=await Ct(n(this,H),n(this,$));t.ok&&t.data&&(n(this,_).push(...t.data.entries),d(this,$,t.data.cursor),d(this,q,n(this,$)!==null),m(this,p,kt).call(this)),d(this,ot,!1)},Ne=function(){d(this,dt,setInterval(async()=>{if(document.hidden)return;const t=await Ct(n(this,H));if(t.ok&&t.data&&t.data.entries.length>0){const s=n(this,_)[0]?.id,i=t.data.entries[0]?.id;s!==i&&(d(this,_,t.data.entries),d(this,$,t.data.cursor),d(this,q,n(this,$)!==null),m(this,p,kt).call(this))}},sn))},ze=async function(){const{openModal:t}=await Promise.resolve().then(()=>pn);t(n(this,Z),n(this,H),n(this,Q),()=>{m(this,p,Gt).call(this)})},Gt=async function(){const t=await Ct(n(this,H));t.ok&&t.data&&(d(this,_,t.data.entries),d(this,$,t.data.cursor),d(this,q,n(this,$)!==null),m(this,p,kt).call(this))};function fe(){const e=document.querySelectorAll('script[src*="widget.js"]'),t=e[e.length-1];if(t?.src){const i=new URL(t.src);L(i.origin)}document.querySelectorAll("[data-sb-id]").forEach(i=>{const r=i.getAttribute("data-sb-id");r&&!i.shadowRoot&&new be(i,r)})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",fe):fe();const on=new MutationObserver(e=>{for(const t of e)for(const s of t.addedNodes)if(s instanceof HTMLElement&&s.hasAttribute("data-sb-id")&&!s.shadowRoot){const i=s.getAttribute("data-sb-id");i&&new be(s,i)}});let me=!1;function ge(){me||!document.body||(me=!0,on.observe(document.body,{childList:!0,subtree:!0}))}document.body?ge():document.addEventListener("DOMContentLoaded",ge,{once:!0});const rn=100,an=5e3,Ot=["#1a1a1a","#6b7280","#2563eb","#dc2626","#16a34a","#9333ea","#ea580c","#ec4899"],Ht=[{label:"Thin",value:4},{label:"Medium",value:8},{label:"Thick",value:14}];class ln{constructor(t,s,i,r){h(this,M);h(this,b);h(this,ht);h(this,j);h(this,z,[]);h(this,T,null);h(this,tt,null);h(this,bt,Ot[0]);h(this,ft,Ht[1].value);h(this,et);h(this,nt);h(this,st);h(this,at);h(this,mt,t=>{if(t.preventDefault(),n(this,tt)!==null||n(this,z).length>=rn)return;d(this,tt,t.pointerId),n(this,b).setPointerCapture(t.pointerId);const[s,i]=m(this,M,Vt).call(this,t);d(this,T,{points:[[s,i,t.pressure||.5]],color:n(this,bt),size:n(this,ft)})});h(this,gt,t=>{if(t.preventDefault(),t.pointerId!==n(this,tt)||!n(this,T)||n(this,z).reduce((o,a)=>o+a.points.length,0)+n(this,T).points.length>=an)return;const[i,r]=m(this,M,Vt).call(this,t);n(this,T).points.push([i,r,t.pressure||.5]),m(this,M,_t).call(this)});h(this,F,t=>{t.pointerId===n(this,tt)&&(d(this,tt,null),n(this,T)&&n(this,T).points.length>1&&(n(this,z).push(n(this,T)),n(this,at).call(this)),d(this,T,null),m(this,M,_t).call(this))});d(this,et,s),d(this,nt,i),d(this,at,r),d(this,st,Math.min(window.devicePixelRatio||1,2)),d(this,b,document.createElement("canvas")),n(this,b).width=s*n(this,st),n(this,b).height=i*n(this,st),n(this,b).style.width=`${s}px`,n(this,b).style.height=`${i}px`,n(this,b).style.touchAction="none",n(this,b).className="sb-canvas",d(this,ht,n(this,b).getContext("2d")),n(this,ht).scale(n(this,st),n(this,st)),d(this,j,document.createElement("div")),n(this,j).className="sb-canvas-preview",n(this,j).style.display="none",t.appendChild(n(this,b)),t.appendChild(n(this,j)),m(this,M,_e).call(this),m(this,M,wt).call(this)}setColor(t){d(this,bt,t)}setSize(t){d(this,ft,t)}undo(){n(this,z).length!==0&&(n(this,z).pop(),n(this,at).call(this),n(this,z).length===0?(n(this,j).style.display="none",n(this,b).style.opacity="1",m(this,M,wt).call(this)):m(this,M,_t).call(this))}clear(){d(this,z,[]),n(this,j).style.display="none",n(this,b).style.opacity="1",m(this,M,wt).call(this),n(this,at).call(this)}isEmpty(){return n(this,z).length===0}getDrawingData(){return{version:1,width:n(this,et),height:n(this,nt),strokes:n(this,z).map(t=>({points:t.points.map(([s,i,r])=>[s,i,r]),color:t.color,size:t.size}))}}destroy(){n(this,b).removeEventListener("pointerdown",n(this,mt)),n(this,b).removeEventListener("pointermove",n(this,gt)),n(this,b).removeEventListener("pointerup",n(this,F)),n(this,b).removeEventListener("pointercancel",n(this,F)),n(this,b).removeEventListener("pointerleave",n(this,F))}}b=new WeakMap,ht=new WeakMap,j=new WeakMap,z=new WeakMap,T=new WeakMap,tt=new WeakMap,bt=new WeakMap,ft=new WeakMap,et=new WeakMap,nt=new WeakMap,st=new WeakMap,at=new WeakMap,M=new WeakSet,_e=function(){n(this,b).addEventListener("pointerdown",n(this,mt),{passive:!1}),n(this,b).addEventListener("pointermove",n(this,gt),{passive:!1}),n(this,b).addEventListener("pointerup",n(this,F)),n(this,b).addEventListener("pointercancel",n(this,F)),n(this,b).addEventListener("pointerleave",n(this,F))},mt=new WeakMap,gt=new WeakMap,F=new WeakMap,Vt=function(t){const s=n(this,b).getBoundingClientRect(),i=Math.round((t.clientX-s.left)/s.width*n(this,et)),r=Math.round((t.clientY-s.top)/s.height*n(this,nt));return[i,r]},wt=function(){n(this,ht).clearRect(0,0,n(this,et),n(this,nt))},_t=function(){m(this,M,wt).call(this);const t=n(this,T)?[...n(this,z),n(this,T)]:n(this,z);if(t.length===0)return;const s={width:n(this,et),height:n(this,nt),strokes:t},i=he(s);n(this,j).innerHTML=i,n(this,j).style.display="block",n(this,b).style.opacity="0"};function cn(e,t){const s=document.createElement("div");s.className="sb-toolbar";const i=document.createElement("div");i.className="sb-color-row",Ot.forEach(c=>{const u=document.createElement("button");u.className="sb-color-btn",u.style.backgroundColor=c,u.setAttribute("aria-label",`Pen color ${c}`),u.addEventListener("click",()=>{t.setColor(c),i.querySelectorAll(".sb-color-btn").forEach(f=>f.classList.remove("sb-active")),u.classList.add("sb-active")}),c===Ot[0]&&u.classList.add("sb-active"),i.appendChild(u)}),s.appendChild(i);const r=document.createElement("div");r.className="sb-size-row",Ht.forEach(c=>{const u=document.createElement("button");u.className="sb-size-btn",u.textContent=c.label,u.setAttribute("aria-label",`Pen size ${c.label}`),u.addEventListener("click",()=>{t.setSize(c.value),r.querySelectorAll(".sb-size-btn").forEach(f=>f.classList.remove("sb-active")),u.classList.add("sb-active")}),c.value===Ht[1].value&&u.classList.add("sb-active"),r.appendChild(u)}),s.appendChild(r);const o=document.createElement("div");o.className="sb-action-row";const a=document.createElement("button");a.className="sb-action-btn",a.textContent="Undo",a.setAttribute("aria-label","Undo last stroke"),a.addEventListener("click",()=>t.undo()),o.appendChild(a);const l=document.createElement("button");l.className="sb-action-btn",l.textContent="Clear",l.setAttribute("aria-label","Clear drawing"),l.addEventListener("click",()=>t.clear()),o.appendChild(l),s.appendChild(o),e.appendChild(s)}const dn=400,un=250;function hn(e,t,s,i){const r=s.settings,o=document.createElement("div");o.className="sb-modal-backdrop",o.setAttribute("role","dialog"),o.setAttribute("aria-modal","true"),o.setAttribute("aria-label","Sign the guestbook");const a=document.createElement("div");a.className="sb-modal";const l=document.createElement("button");l.className="sb-modal-close",l.textContent="×",l.setAttribute("aria-label","Close"),a.appendChild(l);const c=document.createElement("h2");c.className="sb-modal-title",c.textContent=r.cta_text,a.appendChild(c);const u=document.createElement("div");u.className="sb-canvas-area",u.style.backgroundColor=r.canvas_background_color,a.appendChild(u);const f=new ln(u,dn,un,()=>{K()});cn(a,f);const P=document.createElement("div");P.className="sb-form";const v=jt("Your name *","name",!0,100);P.appendChild(v.wrapper);let S=null;r.show_message_field&&(S=jt("Message (optional)","message",!1,200),P.appendChild(S.wrapper));let N=null;r.show_link_field&&(N=jt("Link (optional)","link",!1,500,"url"),N.input.placeholder="https://...",P.appendChild(N.wrapper));const I=document.createElement("input");I.type="text",I.name="_hp",I.tabIndex=-1,I.autocomplete="off",I.style.cssText="position:absolute;left:-9999px;width:1px;height:1px;overflow:hidden",P.appendChild(I);const D=document.createElement("p");D.className="sb-error",D.style.display="none",P.appendChild(D);const R=document.createElement("button");R.className="sb-submit",R.textContent="Submit",R.disabled=!0,P.appendChild(R),a.appendChild(P),o.appendChild(a),e.appendChild(o),document.body.style.overflow="hidden",requestAnimationFrame(()=>v.input.focus());let U=!1;function K(){R.disabled=f.isEmpty()||!v.input.value.trim()||U}v.input.addEventListener("input",K);function St(x){(x.ctrlKey||x.metaKey)&&x.key==="z"&&(x.preventDefault(),f.undo()),x.key==="Escape"&&A()}o.addEventListener("keydown",St);function A(){f.destroy(),document.body.style.overflow="",o.remove()}l.addEventListener("click",A),o.addEventListener("click",x=>{x.target===o&&A()}),R.addEventListener("click",async()=>{if(U||f.isEmpty()||!v.input.value.trim())return;U=!0,R.disabled=!0,R.textContent="Submitting...",D.style.display="none";const x=await Te(t,{name:v.input.value.trim(),message:S?.input.value.trim()||void 0,link:N?.input.value.trim()||void 0,stroke_data:f.getDrawingData(),_hp:I.value||void 0});if(x.ok){try{const O=`sb_del_${x.data.id}`;localStorage.setItem(O,x.data.deletion_token)}catch{}a.innerHTML=`
        <div class="sb-success">
          <p class="sb-success-text">Thanks for signing!</p>
        </div>
      `,setTimeout(()=>{A(),i()},1500)}else U=!1,R.disabled=!1,R.textContent="Submit",D.textContent=x.error.error||"Something went wrong",D.style.display="block"});const vt='button, input, [tabindex]:not([tabindex="-1"])';o.addEventListener("keydown",x=>{if(x.key!=="Tab")return;const O=Array.from(a.querySelectorAll(vt));if(O.length===0)return;const lt=O[0],W=O[O.length-1];x.shiftKey&&document.activeElement===lt?(x.preventDefault(),W.focus()):!x.shiftKey&&document.activeElement===W&&(x.preventDefault(),lt.focus())})}function jt(e,t,s,i,r="text"){const o=document.createElement("div");o.className="sb-field";const a=document.createElement("label");a.className="sb-label",a.textContent=e;const l=document.createElement("input");return l.type=r,l.name=t,l.required=s,l.maxLength=i,l.className="sb-input",l.autocomplete="off",a.appendChild(l),o.appendChild(a),{wrapper:o,input:l}}const pn=Object.freeze(Object.defineProperty({__proto__:null,openModal:hn},Symbol.toStringTag,{value:"Module"}))})();
